function [Rm,Rmi,Sa,Si]=MCRIm(spd,DD,dispyn,lampname,rescaletype);
%Memory colour rendering index
%spd=spectrum (380nm-780nm in 5nm steps)
%DD= degree of adaptation if DD<=1; else DD = illuminance in lux; if unknown: 0.90 gives good general results!
%dispyn = 0,1,2: display indices and plot spiderweb or not; [2,2]; display indices and plot spiderweb2 in colour 2
%lampname= name of test source to be displayed on spiderweb
%rescaletype = 0: no rescaling Ra=Sa; 1: sigmoid rescaling
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clear SimDistrIPT 
format short
%--------------------------------------------------------------------------

%set default values
if nargin ==1;DD=0.90;dispyn=1;cc=1;lampname='';rescaletype=1;end
if nargin ==2;dispyn=1;cc=1;lampname='';rescaletype=1;end
if nargin ==3;lampname='';rescaletype=1;end;
if nargin ==4;rescaletype=1;end;%standard = sigmoid rescaling
%--------------------------------------------------------------------------

%initialize variables
N4=1;
obs=10;% CIE 1964 10° standard observer
XYZwref=[94.81  100.0000  107.32];%D65 is reference white for IPT
%--------------------------------------------------------------------------

%setup cmfs, similarity distributions & error data 
cmf2=[380	385	390	395	400	405	410	415	420	425	430	435	440	445	450	455	460	465	470	475	480	485	490	495	500	505	510	515	520	525	530	535	540	545	550	555	560	565	570	575	580	585	590	595	600	605	610	615	620	625	630	635	640	645	650	655	660	665	670	675	680	685	690	695	700	705	710	715	720	725	730	735	740	745	750	755	760	765	770	775	780
1.36800E-03	2.23600E-03	4.24300E-03	7.65000E-03	1.43100E-02	2.31900E-02	4.35100E-02	7.76300E-02	1.34380E-01	2.14770E-01	2.83900E-01	3.28500E-01	3.48280E-01	3.48060E-01	3.36200E-01	3.18700E-01	2.90800E-01	2.51100E-01	1.95360E-01	1.42100E-01	9.56400E-02	5.79500E-02	3.20100E-02	1.47000E-02	4.90000E-03	2.40000E-03	9.30000E-03	2.91000E-02	6.32700E-02	1.09600E-01	1.65500E-01	2.25750E-01	2.90400E-01	3.59700E-01	4.33450E-01	5.12050E-01	5.94500E-01	6.78400E-01	7.62100E-01	8.42500E-01	9.16300E-01	9.78600E-01	1.02630E+00	1.05670E+00	1.06220E+00	1.04560E+00	1.00260E+00	9.38400E-01	8.54450E-01	7.51400E-01	6.42400E-01	5.41900E-01	4.47900E-01	3.60800E-01	2.83500E-01	2.18700E-01	1.64900E-01	1.21200E-01	8.74000E-02	6.36000E-02	4.67700E-02	3.29000E-02	2.27000E-02	1.58400E-02	1.13592E-02	8.11092E-03	5.79035E-03	4.10946E-03	2.89933E-03	2.04919E-03	1.43997E-03	9.99949E-04	6.90079E-04	4.76021E-04	3.32301E-04	2.34826E-04	1.66151E-04	1.17413E-04	8.30753E-05	5.87065E-05	4.15099E-05
3.90000E-05	6.40000E-05	1.20000E-04	2.17000E-04	3.96000E-04	6.40000E-04	1.21000E-03	2.18000E-03	4.00000E-03	7.30000E-03	1.16000E-02	1.68400E-02	2.30000E-02	2.98000E-02	3.80000E-02	4.80000E-02	6.00000E-02	7.39000E-02	9.09800E-02	1.12600E-01	1.39020E-01	1.69300E-01	2.08020E-01	2.58600E-01	3.23000E-01	4.07300E-01	5.03000E-01	6.08200E-01	7.10000E-01	7.93200E-01	8.62000E-01	9.14850E-01	9.54000E-01	9.80300E-01	9.94950E-01	1.00000E+00	9.95000E-01	9.78600E-01	9.52000E-01	9.15400E-01	8.70000E-01	8.16300E-01	7.57000E-01	6.94900E-01	6.31000E-01	5.66800E-01	5.03000E-01	4.41200E-01	3.81000E-01	3.21000E-01	2.65000E-01	2.17000E-01	1.75000E-01	1.38200E-01	1.07000E-01	8.16000E-02	6.10000E-02	4.45800E-02	3.20000E-02	2.32000E-02	1.70000E-02	1.19200E-02	8.21000E-03	5.72300E-03	4.10200E-03	2.92900E-03	2.09100E-03	1.48400E-03	1.04700E-03	7.40000E-04	5.20000E-04	3.61100E-04	2.49200E-04	1.71900E-04	1.20000E-04	8.48000E-05	6.00000E-05	4.24000E-05	3.00000E-05	2.12000E-05	1.49900E-05
6.45000E-03	1.05500E-02	2.00500E-02	3.62100E-02	6.78500E-02	1.10200E-01	2.07400E-01	3.71300E-01	6.45600E-01	1.03905E+00	1.38560E+00	1.62296E+00	1.74706E+00	1.78260E+00	1.77211E+00	1.74410E+00	1.66920E+00	1.52810E+00	1.28764E+00	1.04190E+00	8.12950E-01	6.16200E-01	4.65180E-01	3.53300E-01	2.72000E-01	2.12300E-01	1.58200E-01	1.11700E-01	7.82500E-02	5.72500E-02	4.21600E-02	2.98400E-02	2.03000E-02	1.34000E-02	8.75000E-03	5.75000E-03	3.90000E-03	2.75000E-03	2.10000E-03	1.80000E-03	1.65000E-03	1.40000E-03	1.10000E-03	1.00000E-03	8.00000E-04	6.00000E-04	3.40000E-04	2.40000E-04	1.90000E-04	1.00000E-04	5.00000E-05	3.00000E-05	2.00000E-05	1.00000E-05	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00	0.00000E+00]';

cmf10=[380	385	390	395	400	405	410	415	420	425	430	435	440	445	450	455	460	465	470	475	480	485	490	495	500	505	510	515	520	525	530	535	540	545	550	555	560	565	570	575	580	585	590	595	600	605	610	615	620	625	630	635	640	645	650	655	660	665	670	675	680	685	690	695	700	705	710	715	720	725	730	735	740	745	750	755	760	765	770	775	780
1.599520E-04	6.624400E-04	2.361600E-03	7.242300E-03	1.910970E-02	4.340000E-02	8.473600E-02	1.406380E-01	2.044920E-01	2.647370E-01	3.146790E-01	3.577190E-01	3.837340E-01	3.867260E-01	3.707020E-01	3.429570E-01	3.022730E-01	2.540850E-01	1.956180E-01	1.323490E-01	8.050700E-02	4.107200E-02	1.617200E-02	5.132000E-03	3.816000E-03	1.544400E-02	3.746500E-02	7.135800E-02	1.177490E-01	1.729530E-01	2.364910E-01	3.042130E-01	3.767720E-01	4.515840E-01	5.298260E-01	6.160530E-01	7.052240E-01	7.938320E-01	8.786550E-01	9.511620E-01	1.014160E+00	1.074300E+00	1.118520E+00	1.134300E+00	1.123990E+00	1.089100E+00	1.030480E+00	9.507400E-01	8.562970E-01	7.549300E-01	6.474670E-01	5.351100E-01	4.315670E-01	3.436900E-01	2.683290E-01	2.043000E-01	1.525680E-01	1.122100E-01	8.126060E-02	5.793000E-02	4.085080E-02	2.862300E-02	1.994130E-02	1.384200E-02	9.576880E-03	6.605200E-03	4.552630E-03	3.144700E-03	2.174960E-03	1.505700E-03	1.044760E-03	7.274500E-04	5.082580E-04	3.563800E-04	2.509690E-04	1.777300E-04	1.263900E-04	9.015100E-05	6.452580E-05	4.633900E-05	3.341170E-05
1.736400E-05	7.156000E-05	2.534000E-04	7.685000E-04	2.004400E-03	4.509000E-03	8.756000E-03	1.445600E-02	2.139100E-02	2.949700E-02	3.867600E-02	4.960200E-02	6.207700E-02	7.470400E-02	8.945600E-02	1.062560E-01	1.282010E-01	1.527610E-01	1.851900E-01	2.199400E-01	2.535890E-01	2.976650E-01	3.391330E-01	3.953790E-01	4.607770E-01	5.313600E-01	6.067410E-01	6.856600E-01	7.617570E-01	8.233300E-01	8.752110E-01	9.238100E-01	9.619880E-01	9.822000E-01	9.917610E-01	9.991100E-01	9.973400E-01	9.823800E-01	9.555520E-01	9.151750E-01	8.689340E-01	8.256230E-01	7.774050E-01	7.203530E-01	6.583410E-01	5.938780E-01	5.279630E-01	4.618340E-01	3.980570E-01	3.395540E-01	2.834930E-01	2.282540E-01	1.798280E-01	1.402110E-01	1.076330E-01	8.118700E-02	6.028100E-02	4.409600E-02	3.180040E-02	2.260170E-02	1.590510E-02	1.113030E-02	7.748800E-03	5.375100E-03	3.717740E-03	2.564560E-03	1.768470E-03	1.222390E-03	8.461900E-04	5.864400E-04	4.074100E-04	2.840410E-04	1.987300E-04	1.395500E-04	9.842800E-05	6.981900E-05	4.973700E-05	3.554050E-05	2.548600E-05	1.833840E-05	1.324900E-05
7.047760E-04	2.927800E-03	1.048220E-02	3.234400E-02	8.601090E-02	1.971200E-01	3.893660E-01	6.567600E-01	9.725420E-01	1.282500E+00	1.553480E+00	1.798500E+00	1.967280E+00	2.027300E+00	1.994800E+00	1.900700E+00	1.745370E+00	1.554900E+00	1.317560E+00	1.030200E+00	7.721250E-01	5.700600E-01	4.152540E-01	3.023560E-01	2.185020E-01	1.592490E-01	1.120440E-01	8.224800E-02	6.070900E-02	4.305000E-02	3.045100E-02	2.058400E-02	1.367600E-02	7.918000E-03	3.988000E-03	1.091000E-03	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00	0.000000E+00]';
cmf=cmf10;
%--------------------------------------------------------------------------

%interpolate spectral power distribution, spd, to the spectral reflectance range  
if ((spd(1,1)-spd(2,1))==(cmf(1,1)-cmf(2,1))) & spd(1,1)==cmf(1,1);else;spd=[interp1(spd(:,1),spd(:,2),cmf(:,1),'spline')];spd(spd<0)=0;spd=[cmf(:,1),spd];end;
%--------------------------------------------------------------------------

%calculate CCT and duv for test white
xyzwt=100.*[sum(spd(:,2).*cmf2(:,2)),sum(spd(:,2).*cmf2(:,3)),sum(spd(:,2).*cmf2(:,4))]./sum(spd(:,2).*cmf2(:,3));
[CCT,dc]=CCTa(xyzwt);
%--------------------------------------------------------------------------

%Determine degree of chromatic adaptation
if DD>1;%DD is actually illuminance
    Yb2=20;La2=(DD/pi)*Yb2/100;%average conditions for CAT02 transform
    DD1=1*(1-(1/3.6)*exp((-La2-42)/92));if DD1<0;DD1=0;end;if DD1>1;DD1=1;end
    DD=DD1;disp(['Degree of adaptation: ',num2str(DD)])
end
DDs=[60:100]./100;DD=formn(DD,2);if DD<0.6;DD=0.6;end;if DD>1;DD=1;end;pD=find(DDs==DD);
%--------------------------------------------------------------------------

%Similarity functions
SiX =[  -0.09651    0.41354     40.64	16.55	-0.17
        0.16548     0.38877     58.27	20.37	-0.59
        0.32825     0.49673     35.97	18.05	-6.04
        0.02115     -0.13658	261.62	110.99	-44.86
        -0.12686	-0.22593	99.06	55.90	-39.86
        0.18488     0.01172     58.23	62.55	-22.86
        -0.03440	0.23480     94.71	32.12    2.90
        0.04258     0.05040     205.54	53.08	-35.20
        0.15829     0.13624     90.21	70.83	-19.01
        -0.01933	-0.02168	742.97	297.66	-227.30
                            ];
a1=SiX(:,1); a2=SiX(:,2); %memory colour chromaticity
a3=SiX(:,3); a4=SiX(:,4);a5=SiX(:,5); %inverse covariance matrix determines shape, size and orientation                    
%--------------------------------------------------------------------------

%Spectral reflectance of objects
objects={'apple','banana','orange','lavender','smurf','strawberry yoghurt','sliced cucumber', 'cauliflower','caucasian skin','N4'};
MCRIrfls=[380	385	390	395	400	405	410	415	420	425	430	435	440	445	450	455	460	465	470	475	480	485	490	495	500	505	510	515	520	525	530	535	540	545	550	555	560	565	570	575	580	585	590	595	600	605	610	615	620	625	630	635	640	645	650	655	660	665	670	675	680	685	690	695	700	705	710	715	720	725	730	735	740	745	750	755	760	765	770	775	780
0.137	0.1389	0.1406	0.1417	0.1447	0.1448	0.147	0.1499	0.1539	0.1548	0.1563	0.1576	0.1617	0.1677	0.174	0.1799	0.1852	0.1887	0.1894	0.1901	0.1924	0.1969	0.2075	0.2241	0.2495	0.2835	0.3274	0.3768	0.4272	0.4722	0.5072	0.5304	0.545	0.555	0.561	0.563	0.5585	0.5469	0.5283	0.5073	0.4885	0.4738	0.4625	0.4537	0.447	0.4388	0.4263	0.4109	0.3972	0.3904	0.3866	0.3793	0.3602	0.33	0.3031	0.2844	0.2653	0.2406	0.219	0.2119	0.223	0.2682	0.3548	0.4735	0.593	0.6904	0.7619	0.8149	0.8557	0.8842	0.8988	0.9068	0.9126	0.9164	0.916	0.9158	0.9159	0.9132	0.9112	0.9108	0.9122
0.036	0.0663	0.0935	0.1172	0.14	0.1579	0.17	0.1745	0.179	0.1795	0.1798	0.18	0.1818	0.1808	0.1788	0.1787	0.1807	0.1858	0.1903	0.1933	0.1935	0.1949	0.2	0.2119	0.232	0.2642	0.3093	0.365	0.4247	0.482	0.5299	0.567	0.5958	0.618	0.6323	0.6406	0.6477	0.6578	0.6697	0.6811	0.6906	0.6991	0.7061	0.7115	0.7155	0.7191	0.7226	0.7266	0.7301	0.7334	0.7361	0.7392	0.7419	0.7453	0.7487	0.752	0.7546	0.757	0.7596	0.7631	0.7677	0.7725	0.7771	0.7808	0.784	0.7856	0.7865	0.7868	0.7873	0.7866	0.7848	0.7831	0.7817	0.782	0.7839	0.7852	0.7872	0.7899	0.7919	0.7942	0.7961
0.0808	0.0867	0.0886	0.0854	0.0823	0.08	0.0803	0.0808	0.0843	0.0864	0.0895	0.0905	0.0918	0.0916	0.0916	0.0933	0.0947	0.0953	0.0961	0.0967	0.0966	0.0967	0.0989	0.1012	0.1052	0.112	0.1232	0.1388	0.1592	0.1848	0.2147	0.2485	0.2848	0.3209	0.3553	0.3854	0.4171	0.4567	0.5034	0.5465	0.5823	0.6131	0.6386	0.6586	0.6749	0.6906	0.7048	0.7179	0.7299	0.7408	0.7502	0.7592	0.7683	0.7755	0.782	0.7879	0.793	0.7965	0.7992	0.8034	0.809	0.8149	0.8201	0.8243	0.8278	0.8303	0.8324	0.8326	0.8325	0.8329	0.8324	0.8309	0.8305	0.8307	0.8319	0.832	0.8346	0.8354	0.8367	0.8384	0.8403
0.0485	0.0562	0.0633	0.0695	0.0754	0.0818	0.0879	0.0923	0.0964	0.1002	0.1036	0.1056	0.1073	0.108	0.1081	0.1076	0.1065	0.1049	0.1023	0.0995	0.0962	0.0927	0.0893	0.086	0.0832	0.0803	0.0778	0.0753	0.0729	0.0709	0.0694	0.0679	0.0677	0.067	0.0663	0.0656	0.067	0.0674	0.0664	0.065	0.0643	0.0647	0.0659	0.0677	0.0691	0.071	0.0726	0.074	0.0741	0.0732	0.0733	0.0721	0.073	0.0737	0.0796	0.0852	0.0906	0.1002	0.1111	0.127	0.1433	0.1645	0.1827	0.2034	0.2249	0.2465	0.2638	0.2794	0.2959	0.3114	0.3255	0.3406	0.3592	0.3764	0.3936	0.4103	0.4268	0.4416	0.4554	0.4688	0.4817
0.0941	0.1116	0.1315	0.155	0.1778	0.1942	0.207	0.2152	0.2198	0.2221	0.2247	0.2284	0.232	0.2353	0.2379	0.24	0.2418	0.2435	0.2442	0.2442	0.2431	0.2427	0.2416	0.24	0.2379	0.2359	0.2326	0.2278	0.2212	0.2129	0.2048	0.1972	0.1884	0.1774	0.1651	0.1539	0.143	0.1318	0.1223	0.116	0.1115	0.1082	0.1065	0.1051	0.099	0.094	0.0935	0.096	0.0953	0.0943	0.095	0.0954	0.0943	0.097	0.1027	0.1057	0.1072	0.1074	0.1105	0.109	0.1066	0.1011	0.0994	0.0985	0.0973	0.0954	0.0935	0.0943	0.0964	0.0994	0.1068	0.1187	0.1318	0.1456	0.1642	0.1879	0.2078	0.2211	0.2344	0.2451	0.2544
0.4642	0.491	0.5106	0.5212	0.5345	0.5487	0.5579	0.553	0.5535	0.5529	0.555	0.5515	0.5433	0.5394	0.5338	0.5368	0.5321	0.532	0.5239	0.5203	0.514	0.5156	0.5175	0.518	0.5187	0.5218	0.5197	0.5148	0.516	0.522	0.5332	0.544	0.5567	0.563	0.5632	0.5573	0.5548	0.5653	0.5834	0.6049	0.6263	0.649	0.6705	0.6872	0.7009	0.7107	0.7185	0.7238	0.7317	0.7395	0.7454	0.75	0.7518	0.7561	0.7608	0.7645	0.7606	0.7565	0.7551	0.759	0.7653	0.7726	0.7773	0.7776	0.7769	0.7789	0.7817	0.7848	0.7869	0.7899	0.7901	0.7889	0.7878	0.7903	0.7973	0.8015	0.8033	0.8047	0.8048	0.8044	0.803
0.2625	0.2687	0.2721	0.2727	0.2701	0.2603	0.2516	0.2454	0.242	0.2382	0.2356	0.2332	0.2352	0.244	0.2599	0.2755	0.2858	0.2902	0.2932	0.294	0.2948	0.2984	0.3106	0.3302	0.3582	0.3929	0.4322	0.4719	0.5085	0.5403	0.5628	0.577	0.5853	0.5903	0.5939	0.5941	0.5908	0.5845	0.5764	0.5654	0.554	0.5444	0.5369	0.5304	0.5258	0.5202	0.5127	0.5018	0.4918	0.4867	0.4865	0.4854	0.4752	0.4551	0.4352	0.4201	0.4017	0.3722	0.3413	0.3197	0.3165	0.3503	0.4254	0.5179	0.5963	0.6501	0.6848	0.7101	0.7309	0.7465	0.7531	0.7546	0.7535	0.7549	0.7572	0.7577	0.7578	0.7584	0.7575	0.7571	0.7565
0.4572	0.4668	0.4696	0.4655	0.4551	0.4458	0.4385	0.4305	0.4259	0.4252	0.4347	0.4502	0.4734	0.4931	0.5059	0.5113	0.5203	0.534	0.5473	0.5533	0.5581	0.5644	0.5734	0.5877	0.613	0.6437	0.6715	0.6924	0.7069	0.7162	0.7212	0.7254	0.7322	0.7398	0.7454	0.7451	0.7321	0.7273	0.7424	0.7657	0.7748	0.778	0.7816	0.7841	0.7867	0.7866	0.7841	0.7837	0.7887	0.7929	0.7952	0.7958	0.7948	0.7949	0.7944	0.7927	0.7952	0.7932	0.7941	0.7863	0.7955	0.8055	0.8169	0.8182	0.822	0.8261	0.8259	0.8297	0.8309	0.8278	0.8247	0.825	0.8264	0.823	0.8196	0.8185	0.8231	0.8261	0.818	0.8164	0.8161
0.0998	0.1057	0.1095	0.1101	0.1119	0.1127	0.114	0.1149	0.1161	0.1177	0.1205	0.1259	0.1351	0.1479	0.1633	0.178	0.1902	0.1996	0.2066	0.2125	0.2175	0.2222	0.2262	0.2304	0.2338	0.2362	0.2373	0.2366	0.2336	0.2286	0.2226	0.2167	0.2127	0.211	0.2126	0.2161	0.2191	0.2203	0.2208	0.2234	0.2307	0.2466	0.2703	0.2972	0.3228	0.3448	0.3625	0.3727	0.3784	0.3836	0.388	0.3926	0.3952	0.3974	0.3973	0.3977	0.3993	0.4014	0.4042	0.4063	0.4071	0.4083	0.4094	0.4116	0.4115	0.4105	0.4112	0.4116	0.412	0.4105	0.4079	0.4068	0.4063	0.4074	0.4032	0.4025	0.4059	0.4032	0.3989	0.3989	0.4018
0.3923	0.3927	0.3931	0.3935	0.3939	0.3943	0.3947	0.3952	0.3955	0.3959	0.3961	0.3963	0.3964	0.3967	0.397	0.3972	0.3974	0.3975	0.3975	0.3976	0.3977	0.3977	0.3978	0.3979	0.398	0.3981	0.3981	0.3981	0.3982	0.3984	0.3985	0.3986	0.3988	0.399	0.3992	0.3994	0.3995	0.3998	0.4001	0.4002	0.4003	0.4004	0.4005	0.4004	0.4005	0.4006	0.4007	0.4006	0.4004	0.4003	0.4003	0.4002	0.4001	0.3999	0.3999	0.3999	0.3999	0.3998	0.3997	0.3996	0.3995	0.3995	0.3994	0.3993	0.3991	0.399	0.3989	0.3989	0.3988	0.3987	0.3985	0.3985	0.3984	0.3984	0.3981	0.3981	0.398	0.398	0.3979	0.3979	0.3979
]';

%--------------------------------------------------------------------------

%calculate test white
xyzwt=100.*[sum(spd(:,2).*cmf(:,2)),sum(spd(:,2).*cmf(:,3)),sum(spd(:,2).*cmf(:,4))]./sum(spd(:,2).*cmf(:,3));

%calculate object colours under test source
for i=1:10;
    xyz(i,:)=100.*[sum(spd(:,2).*cmf(:,2).*MCRIrfls(:,i+1)),sum(spd(:,2).*cmf(:,3).*MCRIrfls(:,i+1)),sum(spd(:,2).*cmf(:,4).*MCRIrfls(:,i+1))]./sum(spd(:,2).*cmf(:,3));;%test white
end
%--------------------------------------------------------------------------

%calculate corresponding colours under D65, the IPT white point
xyzc=xyz2xyzcCAT02_(xyz,xyzwt,XYZwref,DD);
%--------------------------------------------------------------------------

%calculate IPT coordinates
ipt=XYZ2IPT_(xyzc);
pti=[ipt(:,2:3),ipt(:,1)];
%--------------------------------------------------------------------------

%calulate special colour quality indicators Si
Si=exp(-0.5.*(((a3.*((pti(:,1)-a1).^2)+2*a5.*(pti(:,1)-a1).*(pti(:,2)-a2)+a4.*((pti(:,2)-a2).^2)))));
%--------------------------------------------------------------------------

%calculate general colour quality indicator Sa
Sa=geomean(Si);
%--------------------------------------------------------------------------

% Rescale Si and Sa indicators to Rm indices using a sigmoid rescaling function
rescaling_pars=[21.7016   4.2106   2.4154];%Sa=0.5-->0; F4-->50; D65-->90; 1-->100
switch rescaletype
    case 0 %no rescaling
        Rmi=Si;Rm=Sa;
    case 1 
        Rm=SaScaling_(Sa,rescaling_pars);
        Rmi=SaScaling_(Si,rescaling_pars);
end
%--------------------------------------------------------------------------

%--------------------------------------------------------------------------
%PLOT Si values in spiderweb format
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

if dispyn(1)>=1;%display indices and plots
    for i=1:length(objects);object=char(objects(i));for j=1:(18-length(object));object=[object, ' '];end;disp(['Si ',object,': ',num2str(Si(i))]);end
    disp('________________________________________________')
    disp(['Sa                   : ',num2str(Sa),' --> Rm: ',num2str(Rm)])
    disp(' ')
    disp(' ')
    disp(['CCT/duv: ',num2str(CCT),' / ',num2str(dc)])
    disp(' ')
     
    %plot spiderwebs
    hi=hue_angle(pti(:,1),pti(:,2)); hEl=hue_angle(SiX(:,1),SiX(:,2));
    dH=(hi-hEl).*180/pi;dCi=sqrt(pti(:,1).^2+pti(:,2).^2)-sqrt(SiX(:,1).^2+SiX(:,2).^2);
    Ci=sqrt(pti(:,1).^2+pti(:,2).^2);
    colour={'b','r','g','m','c','y','k','b','r','g','m','c','y','k',};
    
switch dispyn(1)
    case 2
    %%plot spiderweb: indices in general direction of hue
    figure(1000);
    ploterror=0;
    %hfixed=[330,30,90,150,210,270];
    hfixed=[30,90,150,210,270,330]-30;%set general hue directions on spiderweb plot
    %hfixed=[0,60,90,150,240,300];
    xmc2=1.*cos(hfixed*pi/180);ymc2=1.*sin(hfixed*pi/180);
    Si2=[Si(6),geomean([Si(3),Si(9)]),geomean([Si(2),Si(8)]),geomean([Si(1),Si(7)]),geomean([Si(5),Si(10)]),Si(4)];%combine Si values of object with approximately the same hue!
    xmiC2=Si2.*cos(hfixed*pi/180);ymiC2=Si2.*sin(hfixed*pi/180);
        
    polar(0,0);hold on;%plot memorycolor
    labels={'Red','Orange','Yellow','Green','Blue','Purple'};
    polarlabels([0,0],hfixed,labels)
       
    tm=0;%plot in different colour and set Sis at a +tm location to the right
    cc=1;if (length(dispyn)>1);cc=dispyn(2);end%plot colour selector
    plot(xmc2,ymc2,'k.');plot(xmiC2,ymiC2,[char(colour(cc+tm)),'o'],'MarkerFacecolor',char(colour(cc+tm)));  
   
    for i=1:(length(Si2)-1)
        line([xmiC2(i);xmiC2(i+1)],[ymiC2(i);ymiC2(i+1)],'LineWidth',1.5,'color',char(colour(cc+tm))),hold on
    end
    line([xmiC2(end);xmiC2(1)],[ymiC2(end);ymiC2(1)],'LineWidth',1.5,'color',char(colour(cc+tm)))
    obj={'ap','ba','or','la','sm','sy','sc','cf','cs','ng'};
    for i=1:length(SiX(:,1))
        Sii=Si(i);Rii=Rmi(i);
        switch rescaletype
            case 0;if length(dispyn)==1 & ploterror==0;text(tm+1.2,0.6-(i-1)*0.14,sprintf('Si-%s = %0.4f ',char(obj(i)),Sii),'Fontsize',15, 'color',char(colour(cc+tm)));t=i;end
            case 1;if length(dispyn)==1 & ploterror==0;text(tm+1.2,0.6-(i-1)*0.14,sprintf('Si-%s = %0.3f ',char(obj(i)),Sii),'Fontsize',15, 'color',char(colour(cc+tm)));t=i;end
        end
    end
    
    if length(dispyn)==1;
         switch rescaletype
             case 0;if ploterror==0;text(1.20,1.04,['Sa = ', sprintf('%0.4f',Sa)],'Fontsize',16, 'color',char(colour(cc+tm)));end
             case 1;if ploterror==0;text(1.20,1.04,['Rm = ', sprintf('%2.1f',Rm)],'Fontsize',16, 'color',char(colour(cc+tm)));end
                    if ploterror==0;text(1.20,0.84,['Sa = ', sprintf('%0.4f',Sa)],'Fontsize',16, 'color',char(colour(cc+tm)));end
         end
      
       switch lampname; case '';otherwise;text(-0.95,-1.3,['Test source: ',lampname],'Fontsize',16, 'color',char(colour(cc)));end
  end
    
    title('Memory Colour Quality Index','FontSize',16)
    plottextpos=[[1.15,1.28];[1.15,1.14];[1.15,1];[1.15,0.86];[1.15,0.72];[1.15,0.58];[1.15,0.44];[1.15,0.30];[1.15,0.16];[1.15,0.02]];plottextpos(:,2)=plottextpos(:,2)-0.14;
    if length(dispyn)>1 & nargin>3;plottextpos=plottextpos(2:end,:);text(plottextpos(cc,1)+0.7,plottextpos(cc,2),['  (', lampname,')'],'Fontsize',16, 'color',char(colour(cc+tm)));end
     
    if ploterror==0;
       switch rescaletype
        case 1
            text(plottextpos(cc,1)+0.05,plottextpos(cc,2)-0.1,['Rm = ', sprintf('%2.1f',Rm)],'Fontsize',16, 'color',char(colour(cc)));
        case 0
            text(plottextpos(cc,1)+0.05,plottextpos(cc,2)-0.1,['Sa = ', sprintf('%0.3f',Sa)],'Fontsize',16, 'color',char(colour(cc)));
        end
       
    end
    text('Fontsize',16, 'color',char(colour(cc)))

     case 1
    %%plot spiderweb: indices in general direction of hue
    figure(1001);
    ploterror=0;
    Si2=[Si(6),geomean([Si(3),Si(9)]),geomean([Si(2),Si(8)]),geomean([Si(1),Si(7)]),geomean([Si(5),Si(10)]),Si(4)];%combine Si values of object with approximately the same hue!
    labels={'Red','Orange','Yellow','Green','Blue','Purple'};
    tm=1;%plot in different colour and set Sis at a +tm location to the right
    cc=1;if (length(dispyn)>1);cc=dispyn(2);end%plot colour selector
    radarplot([ones(1,length(labels));Si2],labels,[{'k'},colour(cc+tm)],[{'w'},colour(cc+tm)]);
    obj={'ap','ba','or','la','sm','sy','sc','cf','cs','ng'};
    for i=1:length(SiX(:,1))
        Sii=Si(i);Rii=Rmi(i);
        switch rescaletype
            case 0;if length(dispyn)==1 & ploterror==0;text(tm+1.3,0.6-(i-1)*0.14,sprintf('Si-%s = %0.4f ',char(obj(i)),Sii),'Fontsize',15, 'color',char(colour(cc+tm)));t=i;end
            case 1;if length(dispyn)==1 & ploterror==0;text(tm+1.3,0.6-(i-1)*0.14,sprintf('Si-%s = %0.3f ',char(obj(i)),Sii),'Fontsize',15, 'color',char(colour(cc+tm)));t=i;end
        end
    end
    
    if length(dispyn)==1;
         switch rescaletype
             case 0;if ploterror==0;text(1.30+tm,1.04,['Sa = ', sprintf('%0.4f',Sa)],'Fontsize',16, 'color',char(colour(cc+tm)));end
             case 1;if ploterror==0;text(1.30+tm,1.04,['Rm = ', sprintf('%2.1f',Rm)],'Fontsize',16, 'color',char(colour(cc+tm)));end
                    if ploterror==0;text(1.30+tm,0.84,['Sa = ', sprintf('%0.4f',Sa)],'Fontsize',16, 'color',char(colour(cc+tm)));end
         end
      
        switch lampname; case '';otherwise;text(-0.95,-1.3,['Test source: ',lampname],'Fontsize',16, 'color',char(colour(cc)));end
    end
    
    title('Memory Colour Quality Index','FontSize',16)
    plottextpos=[[1.15,1.28];[1.15,1.14];[1.15,1];[1.15,0.86];[1.15,0.72];[1.15,0.58];[1.15,0.44];[1.15,0.30];[1.15,0.16];[1.15,0.02]];plottextpos(:,2)=plottextpos(:,2)-0.14;
     if length(dispyn)>1 & nargin>3;plottextpos=plottextpos(2:end,:);text(plottextpos(cc,1)+0.7,plottextpos(cc,2),['  (', lampname,')'],'Fontsize',16, 'color',char(colour(cc+tm)));end
     if ploterror==0;
        switch rescaletype
        case 1
            text(plottextpos(cc,1)+0.15,plottextpos(cc,2)-0.1,['Rm = ', sprintf('%2.1f',Rm)],'Fontsize',16, 'color',char(colour(cc+tm)));
        case 0
            text(plottextpos(cc,1)+0.15,plottextpos(cc,2)-0.1,['Sa = ', sprintf('%0.3f',Sa)],'Fontsize',16, 'color',char(colour(cc+tm)));
        end
       
    end
    text('Fontsize',16, 'color',char(colour(cc)))
    
    case 3
    %%plot spiderweb2
    figure(1002);
    ploterror=0;
    obj={'ap','ba','or','la','sm','sy','sc','cf','cs','ng'};
    [hs,Is]=sortrows(hEl);Si2=Si(Is)';labels=obj(Is);
    tm=0;%plot in different colour and set Sis at a +tm location to the right
    cc=1;if (length(dispyn)>1);cc=dispyn(2);end%plot colour selector
    radarplot([ones(1,length(labels));Si2],labels,[{'k'},colour(cc+tm)],[{'w'},colour(cc+tm)]);
    for i=1:length(SiX(:,1))
        Sii=Si(i);Rii=Rmi(i);
        switch rescaletype
            case 0;if length(dispyn)==1 & ploterror==0;text(tm+1.3,0.6-(i-1)*0.14,sprintf('Si-%s = %0.4f ',char(obj(i)),Sii),'Fontsize',15, 'color',char(colour(cc+tm)));t=i;end
            case 1;if length(dispyn)==1 & ploterror==0;text(tm+1.3,0.6-(i-1)*0.14,sprintf('Si-%s = %0.3f ',char(obj(i)),Sii),'Fontsize',15, 'color',char(colour(cc+tm)));t=i;end
        end
    end
    
    if length(dispyn)==1;
         switch rescaletype
             case 0;if ploterror==0;text(1.30,1.04,['Sa = ', sprintf('%0.4f',Sa)],'Fontsize',16, 'color',char(colour(cc+tm)));end
             case 1;if ploterror==0;text(1.30,1.04,['Rm = ', sprintf('%2.1f',Rm)],'Fontsize',16, 'color',char(colour(cc+tm)));end
                    if ploterror==0;text(1.30,0.84,['Sa = ', sprintf('%0.4f',Sa)],'Fontsize',16, 'color',char(colour(cc+tm)));end
         end
      
        switch lampname; case '';otherwise;text(-0.95,-1.3,['Test source: ',lampname],'Fontsize',16, 'color',char(colour(cc)));end
    end
    
    title('Memory Colour Quality Index','FontSize',16)
    plottextpos=[[1.15,1.28];[1.15,1.14];[1.15,1];[1.15,0.86];[1.15,0.72];[1.15,0.58];[1.15,0.44];[1.15,0.30];[1.15,0.16];[1.15,0.02]];plottextpos(:,2)=plottextpos(:,2)-0.14;
    if length(dispyn)>1 & nargin>3;plottextpos=plottextpos(2:end,:);text(plottextpos(cc,1)+0.7,plottextpos(cc,2),['  (', lampname,')'],'Fontsize',16, 'color',char(colour(cc+tm)));end
     if ploterror==0;
        switch rescaletype
        case 1
            text(plottextpos(cc,1)+0.15,plottextpos(cc,2)-0.1,['Rm = ', sprintf('%2.1f',Rm)],'Fontsize',16, 'color',char(colour(cc)));
        case 0
            text(plottextpos(cc,1)+0.15,plottextpos(cc,2)-0.1,['Sa = ', sprintf('%0.3f',Sa)],'Fontsize',16, 'color',char(colour(cc)));
        end
       
    end
    text('Fontsize',16, 'color',char(colour(cc)))
    
    case 4
    %plot spiderweb: : all indices on hue angle
    figure(1003)
    
    xmc=1.*cos(hEl*pi/180);ymc=1.*sin(hEl*pi/180);
    xmi=Si.*cos(hi*pi/180);ymi=Si.*sin(hi*pi/180);
    xmiC=Si.*cos(hEl*pi/180);ymiC=Si.*sin(hEl*pi/180);
    polar(0,0);hold on;%plot memorycolor
    cc=1;if (length(dispyn)>1);cc=dispyn(2);end%plot colour selector
    plot(xmc,ymc,'k.');plot(xmiC,ymiC,[char(colour(cc)),'o'],'MarkerFacecolor',char(colour(cc)));
    obj={'ap','ba','or','la','sm','sy','sc','cf','cs','ng'};
    for i=1:length(SiX(:,1))
        line([0;xmiC(i)],[0;ymiC(i)],'LineWidth',1.5,'color',char(colour(cc)))
        Sii=Si(i);
        if length(dispyn)==1;text(1.2,0.6-(i-1)*0.14,['Si-',char(obj(i)),' = ', sprintf('%0.3f',Sii)],'Fontsize',15, 'color',char(colour(cc)));t=i;end
    end
    if length(dispyn)==1;
        text(1.20,1.04,['Sa = ', sprintf('%0.4f',Sa)],'Fontsize',16, 'color',char(colour(cc)));
       switch lampname; case '';otherwise;text(-0.95,-1.3,['Test source: ',lampname],'Fontsize',16, 'color',char(colour(cc)));end
    end
    
    title('Memory Colour Quality Index','FontSize',16)
    plottextpos=[[-0.93,0.08];[1.15,1.14];[1.15,1];[1.15,0.86];[1.15,0.72];[1.15,0.58];[1.15,0.44];[1.15,0.30];[1.15,0.16];[1.15,0.02]];
    if length(dispyn)>1;plottextpos=plottextpos(2:end,:);text(plottextpos(cc,1)+0.7,plottextpos(cc,2),['(', lampname,')'],'Fontsize',16, 'color',char(colour(cc)));end
    switch rescaletype
        case 1
            text(plottextpos(cc,1)+0.05,plottextpos(cc,2)-0.1,['Rm = ', sprintf('%2.1f',Rm)],'Fontsize',16, 'color',char(colour(cc)))
       
        case 0
            text(plottextpos(cc,1)+0.05,plottextpos(cc,2)-0.1,['Sa = ', sprintf('%0.3f',Sa)],'Fontsize',16, 'color',char(colour(cc)))
    end
    text('Fontsize',16, 'color',char(colour(cc)))

     
end%switch

end%if

end%function


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function XYZc=xyz2xyzcCAT02_(XYZ,XYZ1w,XYZ2w,Dc)
%transform XYZ under XYZ1w to the corresponding colours under XYZ2w
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%CAT02 chromatic adaptation
MCAT02=[0.7328,0.4296,-0.1624;
-0.7036,1.6975,0.0061;
0.0030,0.0136,0.9834];
MCAT=MCAT02;

% CAT02 inverse matrix
MCATi=inv(MCAT02);

D=Dc;%degree is already determined in main function

% Convert XYZ data to CAT02 LMS space
RGB=(MCAT*XYZ')';R=RGB(:,1);G=RGB(:,2);B=RGB(:,3);
RGBw=(MCAT*XYZ1w')';Rw=RGBw(:,1);Gw=RGBw(:,2);Bw=RGBw(:,3);
RGBw2=(MCAT*XYZ2w')';Rw2=RGBw2(:,1);Gw2=RGBw2(:,2);Bw2=RGBw2(:,3);

% Apply chromatic adaptation (Ill. 1 --> Ill.2)
Rc=(D*(Rw2./Rw)+1-D).*R;
Gc=(D*(Gw2./Gw)+1-D).*G;
Bc=(D*(Bw2./Bw)+1-D).*B;
RGBc=[Rc,Gc,Bc];

% Calculate XYZ
XYZc=(MCATi*RGBc')';
XYZc(XYZc<0)=0;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function IPT=XYZ2IPT_(XYZ)
%transform from XYZ to IPT
%________________________________

%calculate relative tristimulus values
XYZ=XYZ./100;

%convert XYZ to LMS space
Mlms10d=[ 0.400070	0.707270	-0.080674;-0.228111	1.150561	0.061230;0.000000	0.000000	0.931757];
LMS=(Mlms10d*XYZ')';

%response compression: LMS to LMSprime
LMS=((((LMS>=0).*LMS).^0.43)-(((LMS<0).*(-LMS)).^0.43));

%convert LMSprime to IPT coordinates
Mipt=[0.4000,0.4000,0.2000;4.4550,-4.8510,0.3960;0.8056,0.3572,-1.1628];
IPT=(Mipt*LMS')';
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function Rm=SaScaling_(Sa,par)
p1=par(1);p2=par(2);p3=par(3);
%d=sqrt(-2*log(Sa));Rm=100.*(2.*exp(-p1.*d.^p2)./(1+exp(-p1.*d.^p2))).^p3;par=[1.172123   8.421214   2.415432]
Rm=100.*(2./(exp(p1.*(abs(log(Sa))).^p2)+1)).^p3;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function [CCT,mindc]=CCTa(XYZWT)
ColourTemp=[997.506234413965,0.448590660433443,0.354574670344607;1000,0.448005848828648,0.354625418313254;1002.50000000000,0.447421125440153,0.354676062640834;1005.00625000000,0.446836496438103,0.354726601777165;1007.51876562500,0.446251967970019,0.354777034168799;1010.03756253906,0.445667546160699,0.354827358259050;1012.56265644541,0.445083237112092,0.354877572488026;1015.09406308652,0.444499046903179,0.354927675292656;1017.63179824424,0.443914981589860,0.354977665106717;1020.17587773985,0.443331047204851,0.355027540360869;1022.72631743420,0.442747249757567,0.355077299482684;1025.28313322779,0.442163595234017,0.355126940896677;1027.84634106085,0.441580089596701,0.355176463024334;1030.41595691351,0.440996738784507,0.355225864284152;1032.99199680579,0.440413548712612,0.355275143091665;1035.57447679780,0.439830525272384,0.355324297859481;1038.16341298980,0.439247674331282,0.355373326997312;1040.75882152227,0.438665001732774,0.355422228912013;1043.36071857608,0.438082513296233,0.355471002007614;1045.96912037252,0.437500214816860,0.355519644685355;1048.58404317345,0.436918112065585,0.355568155343723;1051.20550328138,0.436336210788996,0.355616532378489;1053.83351703959,0.435754516709248,0.355664774182742;1056.46810083219,0.435173035523985,0.355712879146931;1059.10927108427,0.434591772906264,0.355760845658899;1061.75704426198,0.434010734504477,0.355808672103924;1064.41143687263,0.433429925942281,0.355856356864755;1067.07246546481,0.432849352818525,0.355903898321658;1069.74014662848,0.432269020707182,0.355951294852447;1072.41449699505,0.431688935157276,0.355998544832533;1075.09553323754,0.431109101692829,0.356045646634963;0.000482542001234893,0.430529525812789,0.356092598630458;1080.47773025081,0.429950212990972,0.356139399187460;1083.17892457643,0.429371168676007,0.356186046672174;1085.88687188787,0.428792398291276,0.356232539448610;1088.60158906759,0.428213907234858,0.356278875878627;1091.32309304026,0.427635700879485,0.356325054321980;1094.05140077286,0.427057784572485,0.356371073136364;1096.78652927479,0.426480163635736,0.356416930677458;1099.52849559798,0.425902843365620,0.356462625298975;1102.27731683698,0.425325829032981,0.356508155352705;1105.03301012907,0.424749125883081,0.356553519188564;1107.79559265439,0.424172739135563,0.356598715154645;1110.56508163603,0.423596673984408,0.356643741597260;1113.34149434012,0.423020935597906,0.356688596860996;1116.12484807597,0.422445529118617,0.356733279288759;1118.91516019616,0.421870459663341,0.356777787221829;1121.71244809665,0.421295732323090,0.356822118999909;1124.51672921689,0.420721352163056,0.356866272961173;1127.32802103993,0.420147324222590,0.356910247442325;1130.14634109253,0.419573653515171,0.356954040778644;1132.97170694526,0.419000345028392,0.356997651304045;1135.80413621263,0.418427403723932,0.357041077351123;1138.64364655316,0.417854834537544,0.357084317251217;1141.49025566954,0.417282642379033,0.357127369334458;1144.34398130871,0.416710832132245,0.357170231929828;1147.20484126199,0.416139408655050,0.357212903365212;1150.07285336514,0.415568376779337,0.357255381967460;1152.94803549855,0.414997741310996,0.357297666062439;1155.83040558730,0.414427507029919,0.357339753975092;1158.71998160127,0.413857678689986,0.357381644029500;1161.61678155527,0.413288261019068,0.357423334548933;1164.52082350916,0.412719258719021,0.357464823855916;1167.43212556793,0.412150676465684,0.357506110272285;1170.35070588185,0.411582518908881,0.357547192119249;1173.27658264656,0.411014790672423,0.357588067717450;1176.20977410317,0.410447496354117,0.357628735387026;1179.15029853843,0.409880640525762,0.357669193447670;1182.09817428478,0.409314227733164,0.357709440218694;1185.05341972049,0.408748262496145,0.357749474019094;1188.01605326979,0.408182749308548,0.357789293167609;1190.98609340296,0.407617692638256,0.357828895982790;1193.96355863647,0.407053096927199,0.357868280783061;1196.94846753306,0.406488966591369,0.357907445886786;1199.94083870190,0.405925306020850,0.357946389612332;1202.94069079865,0.405362119579815,0.357985110278140;1205.94804252565,0.404799411606563,0.358023606202787;1208.96291263196,0.404237186413530,0.358061875705055;1211.98531991354,0.403675448287316,0.358099917103998;1215.01528321332,0.403114201488706,0.358137728719012;1218.05282142136,0.402553450252700,0.358175308869902;1221.09795347491,0.401993198788531,0.358212655876950;1224.15069835860,0.401433451279703,0.358249768060989;1227.21107510449,0.400874211884013,0.358286643743468;1230.27910279226,0.400315484733582,0.358323281246525;1233.35480054924,0.399757273934892,0.358359678893058;1236.43818755061,0.399199583568814,0.358395835006799;1239.52928301949,0.398642417690643,0.358431747912380;1242.62810622703,0.398085780330136,0.358467415935411;1245.73467649260,0.397529675491547,0.358502837402551;1248.84901318383,0.396974107153664,0.358538010641581;1251.97113571679,0.396419079269850,0.358572933981477;1255.10106355608,0.395864595768083,0.358607605752488;1258.23881621497,0.395310660550995,0.358642024286207;1261.38441325551,0.394757277495918,0.358676187915646;1264.53787428865,0.394204450454928,0.358710094975316;1267.69921897437,0.393652183254882,0.358743743801298;1270.86846702181,0.393100479697475,0.358777132731321;1274.04563818936,0.392549343559278,0.358810260104840;1277.23075228484,0.391998778591790,0.358843124263112;1280.42382916555,0.391448788521485,0.358875723549276;1283.62488873846,0.390899377049863,0.358908056308426;1286.83395096031,0.390350547853499,0.358940120887695;1290.05103583771,0.389802304584099,0.358971915636329;1293.27616342730,0.389254650868546,0.359003438905769;1296.50935383587,0.388707590308956,0.359034689049733;1299.75062722046,0.388161126482738,0.359065664424287;1303.00000378851,0.387615262942638,0.359096363387936;1306.25750379798,0.387070003216807,0.359126784301697;1309.52314755748,0.386525350808850,0.359156925529182;1312.79695542637,0.385981309197885,0.359186785436681;1316.07894781494,0.385437881838603,0.359216362393241;1319.36914518447,0.384895072161328,0.359245654770751;1322.66756804744,0.384352883572075,0.359274660944019;1325.97423696755,0.383811319452611,0.359303379290859;1329.28917255997,0.383270383160517,0.359331808192173;1332.61239549137,0.382730078029250,0.359359946032034;1335.94392648010,0.382190407368207,0.359387791197764;1339.28378629630,0.381651374462783,0.359415342080029;1342.63199576204,0.381112982574446,0.359442597072910;1345.98857575145,0.380575234940791,0.359469554573997;1349.35354719083,0.380038134775610,0.359496212984468;1352.72693105880,0.379501685268960,0.359522570709174;1356.10874838645,0.378965889587223,0.359548626156726;1359.49902025742,0.378430750873179,0.359574377739580;1362.89776780806,0.377896272246074,0.359599823874117;1366.30501222758,0.377362456801681,0.359624962980736;1369.72077475815,0.376829307612379,0.359649793483934;1373.14507669504,0.376296827727213,0.359674313812395;1376.57793938678,0.375765020171969,0.359698522399073;1380.01938423525,0.375233887949240,0.359722417681282;1383.46943269584,0.374703434038502,0.359745998100778;1386.92810627758,0.374173661396180,0.359769262103848;1390.39542654327,0.373644572955721,0.359792208141397;1393.87141510963,0.373116171627667,0.359814834669031;1397.35609364740,0.372588460299724,0.359837140147151;1400.84948388152,0.372061441836839,0.359859123041030;1404.35160759122,0.371535119081267,0.359880781820910;1407.86248661020,0.371009494852650,0.359902114962081;1411.38214282673,0.370484571948087,0.359923120944975;1414.91059818379,0.369960353142208,0.359943798255246;1418.44787467925,0.369436841187249,0.359964145383865;1421.99399436595,0.368914038813123,0.359984160827202;1425.54897935187,0.368391948727505,0.360003843087113;1429.11285180025,0.367870573615891,0.360023190671033;1432.68563392975,0.367349916141684,0.360042202092057;1436.26734801457,0.366829978946268,0.360060875869033;1439.85801638461,0.366310764649079,0.360079210526643;1443.45766142557,0.365792275847687,0.360097204595498;1447.06630557913,0.365274515117866,0.360114856612220;1450.68397134308,0.364757485013672,0.360132165119531;1454.31068127144,0.364241188067520,0.360149128666340;1457.94645797462,0.363725626790260,0.360165745807833;1461.59132411955,0.363210803671250,0.360182015105556;1465.24530242985,0.362696721178441,0.360197935127505;1468.90841568593,0.362183381758442,0.360213504448213;1472.58068672514,0.361670787836606,0.360228721648834;1476.26213844195,0.361158941817104,0.360243585317235;1479.95279378806,0.360647846082995,0.360258094048080;1483.65267577253,0.360137502996317,0.360272246442916;1487.36180746196,0.359627914898150,0.360286041110260;1491.08021198061,0.359119084108702,0.360299476665686;1494.80791251057,0.358611012927378,0.360312551731913;1498.54493229184,0.358103703632866,0.360325264938887;1502.29129462257,0.357597158483207,0.360337614923870;1506.04702285913,0.357091379715875,0.360349600331525;1509.81214041628,0.356586369547851,0.360361219814003;1513.58667076732,0.356082130175704,0.360372472031023;1517.37063744423,0.355578663775663,0.360383355649965;1521.16406403784,0.355075972503701,0.360393869345949;1524.96697419794,0.354574058495600,0.360404011801922;1528.77939163343,0.354072923867040,0.360413781708741;1532.60134011252,0.353572570713667,0.360423177765261;1536.43284346280,0.353073001111173,0.360432198678414;1540.27392557146,0.352574217115371,0.360440843163293;1544.12461038538,0.352076220762274,0.360449109943242;1547.98492191135,0.351579014068165,0.360456997749930;1551.85488421613,0.351082599029678,0.360464505323439;1555.73452142667,0.350586977623874,0.360471631412347;1559.62385773023,0.350092151808315,0.360478374773806;1563.52291737456,0.349598123521137,0.360484734173627;1567.43172466799,0.349104894681128,0.360490708386361;1571.35030397966,0.348612467187806,0.360496296195380;1575.27867973961,0.348120842921488,0.360501496392956;1579.21687643896,0.347630023743369,0.360506307780343;1583.16491863006,0.347140011495596,0.360510729167857;1587.12283092664,0.346650808001341,0.360514759374954;1591.09063800395,0.346162415064875,0.360518397230311;1595.06836459896,0.345674834471644,0.360521641571904;1599.05603551046,0.345188067988342,0.360524491247083;1603.05367559923,0.344702117362986,0.360526945112657;1607.06130978823,0.344216984324983,0.360529002034964;1611.07896306270,0.343732670585215,0.360530660889952;1615.10666047036,0.343249177836098,0.360531920563253;1619.14442712154,0.342766507751666,0.360532779950262;1623.19228818934,0.342284661987634,0.360533237956210;1627.25026890981,0.341803642181482,0.360533293496239;1631.31839458209,0.341323449952514,0.360532945495477;1635.39669056854,0.340844086901940,0.360532192889113;1639.48518229496,0.340365554612939,0.360531034622469;1643.58389525070,0.339887854650737,0.360529469651071;1647.69285498883,0.339410988562674,0.360527496940726;1651.81208712630,0.338934957878276,0.360525115467590;1655.94161734412,0.338459764109324,0.360522324218238;1660.08147138748,0.337985408749928,0.360519122189741;1664.23167506594,0.337511893276589,0.360515508389729;1668.39225425361,0.337039219148276,0.360511481836464;1672.56323488924,0.336567387806493,0.360507041558906;1676.74464297647,0.336096400675347,0.360502186596786;1680.93650458391,0.335626259161614,0.360496916000669;1685.13884584537,0.335156964654814,0.360491228832023;1689.35169295998,0.334688518527273,0.360485124163284;1693.57507219238,0.334220922134193,0.360478601077924;1697.80900987286,0.333754176813718,0.360471658670513;1702.05353239754,0.333288283887007,0.360464296046785;1706.30866622854,0.332823244658291,0.360456512323702;1710.57443789411,0.332359060414947,0.360448306629516;1714.85087398884,0.331895732427561,0.360439678103832;1719.13800117381,0.331433261949995,0.360430625897668;1723.43584617675,0.330971650219450,0.360421149173518;1727.74443579219,0.330510898456539,0.360411247105411;1732.06379688167,0.330051007865339,0.360400918878971;1736.39395637388,0.329591979633469,0.360390163691473;1740.73494126481,0.329133814932144,0.360378980751907;1745.08677861797,0.328676514916246,0.360367369281028;1749.44949556452,0.328220080724382,0.360355328511418;1753.82311930343,0.327764513478954,0.360342857687539;1758.20767710169,0.327309814286215,0.360329956065788;1762.60319629444,0.326855984236336,0.360316622914553;1767.00970428518,0.326403024403467,0.360302857514263;1771.42722854589,0.325950935845799,0.360288659157444;1775.85579661725,0.325499719605628,0.360274027148771;1780.29543610880,0.325049376709414,0.360258960805114;1784.74617469907,0.324599908167841,0.360243459455594;1789.20804013582,0.324151314975882,0.360227522441630;1793.68106023616,0.323703598112856,0.360211149116987;1798.16526288675,0.323256758542489,0.360194338847824;1802.66067604396,0.322810797212977,0.360177091012742;1807.16732773407,0.322365715057039,0.360159405002829;1811.68524605341,0.321921512991983,0.360141280221705;1816.21445916854,0.321478191919761,0.360122716085568;1820.75499531646,0.321035752727030,0.360103712023236;1825.30688280475,0.320594196285208,0.360084267476189;1829.87015001177,0.320153523450535,0.360064381898612;1834.44482538679,0.319713735064127,0.360044054757438;1839.03093745026,0.319274831952038,0.360023285532384;1843.62851479389,0.318836814925314,0.360002073715990;1848.23758608087,0.318399684780052,0.359980418813664;1852.85818004607,0.317963442297452,0.359958320343711;1857.49032549619,0.317528088243881,0.359935777837374;1862.13405130993,0.317093623370922,0.359912790838869;1866.78938643820,0.316660048415435,0.359889358905419;1871.45635990430,0.316227364099608,0.359865481607289;1876.13500080406,0.315795571131017,0.359841158527816;1880.82533830607,0.315364670202674,0.359816389263447;1885.52740165184,0.314934661993090,0.359791173423761;1890.24122015597,0.314505547166325,0.359765510631508;1894.96682320635,0.314077326372041,0.359739400522633;1899.70424026437,0.313650000245557,0.359712842746306;1904.45350086503,0.313223569407906,0.359685836964948;1909.21463461719,0.312798034465883,0.359658382854259;1913.98767120374,0.312373396012100,0.359630480103243;1918.77264038175,0.311949654625041,0.359602128414232;1923.56957198270,0.311526810869114,0.359573327502911;1928.37849591266,0.311104865294698,0.359544077098337;1933.19944215244,0.310683818438205,0.359514376942966;1938.03244075782,0.310263670822120,0.359484226792669;1942.87752185971,0.309844422955065,0.359453626416754;1947.73471566436,0.309426075331842,0.359422575597986;1952.60405245352,0.309008628433485,0.359391074132601;1957.48556258466,0.308592082727315,0.359359121830327;1962.37927649112,0.308176438666987,0.359326718514399;1967.28522468235,0.307761696692541,0.359293864021569;1972.20343774405,0.307347857230456,0.359260558202130;1977.13394633841,0.306934920693694,0.359226800919920;1982.07678120426,0.306522887481755,0.359192592052337;1987.03197315727,0.306111757980723,0.359157931490353;1991.99955309016,0.305701532563319,0.359122819138519;1996.97955197289,0.305292211588948,0.359087254914979;2001.97200085282,0.304883795403749,0.359051238751474;2006.97693085495,0.304476284340643,0.359014770593355;2011.99437318209,0.304069678719383,0.358977850399582;2017.02435911504,0.303663978846599,0.358940478142734;2022.06692001283,0.303259185015853,0.358902653809015;2027.12208731286,0.302855297507682,0.358864377398252;2032.18989253115,0.302452316589646,0.358825648923901;2037.27036726247,0.302050242516379,0.358786468413049;2042.36354318063,0.301649075529635,0.358746835906412;2047.46945203858,0.301248815858334,0.358706751458336;2052.58812566868,0.300849463718612,0.358666215136795;2057.71959598285,0.300451019313866,0.358625227023391;2062.86389497281,0.300053482834803,0.358583787213348;2068.02105471024,0.299656854459486,0.358541895815507;2073.19110734701,0.299261134353381,0.358499552952324;2078.37408511538,0.298866322669403,0.358456758759860;2083.57002032817,0.298472419547965,0.358413513387780;2088.77894537899,0.298079425117018,0.358369816999335;2094.00089274244,0.297687339492106,0.358325669771364;2099.23589497429,0.297296162776406,0.358281071894276;2104.48398471173,0.296905895060778,0.358236023572043;2109.74519467351,0.296516536423805,0.358190525022185;2115.01955766019,0.296128086931845,0.358144576475761;2120.30710655434,0.295740546639075,0.358098178177354;2125.60787432073,0.295353915587535,0.358051330385054;2130.92189400653,0.294968193807174,0.358004033370444;2136.24919874154,0.294583381315895,0.357956287418585;2141.58982173840,0.294199478119606,0.357908092827997;2146.94379629274,0.293816484212253,0.357859449910638;2152.31115578348,0.293434399575878,0.357810358991891;2157.69193367293,0.293053224180657,0.357760820410538;2163.08616350712,0.292672957984946,0.357710834518743;2168.49387891588,0.292293600935327,0.357660401682025;2173.91511361317,0.291915152966650,0.357609522279240;2179.34990139721,0.291537614002086,0.357558196702556;2184.79827615070,0.291160983953158,0.357506425357426;2190.26027184108,0.290785262719799,0.357454208662565;2195.73592252068,0.290410450190389,0.357401547049921;2201.22526232698,0.290036546241800,0.357348440964652;2206.72832548280,0.289663550739444,0.357294890865092;2212.24514629650,0.289291463537315,0.357240897222725;2217.77575916224,0.288920284478033,0.357186460522156;2223.32019856015,0.288550013392889,0.357131581261079;2228.87849905655,0.288180650101891,0.357076259950244;2234.45069530419,0.287812194413803,0.357020497113425;2240.03682204245,0.287444646126195,0.356964293287391;2245.63691409756,0.287078005025487,0.356907649021864;2251.25100638280,0.286712270886987,0.356850564879490;2256.87913389876,0.286347443474942,0.356793041435800;2262.52133173351,0.285983522542579,0.356735079279176;2268.17763506284,0.285620507832147,0.356676679010810;2273.84807915050,0.285258399074967,0.356617841244668;2279.53269934837,0.284897195991471,0.356558566607452;2285.23153109674,0.284536898291247,0.356498855738557;2290.94460992448,0.284177505673086,0.356438709290031;2296.67197144930,0.283819017825019,0.356378127926535;2302.41365137792,0.283461434424371,0.356317112325301;2308.16968550636,0.283104755137797,0.356255663176086;2313.94010972013,0.282748979621329,0.356193781181131;2319.72495999443,0.282394107520419,0.356131467055114;2325.52427239441,0.282040138469986,0.356068721525109;2331.33808307540,0.281687072094454,0.356005545330534;2337.16642828309,0.281334908007804,0.355941939223108;2343.00934435380,0.280983645813613,0.355877903966803;2348.86686771468,0.280633285105096,0.355813440337795;2354.73903488397,0.280283825465156,0.355748549124414;2360.62588247118,0.279935266466425,0.355683231127099;2366.52744717736,0.279587607671306,0.355617487158339;2372.44376579530,0.279240848632021,0.355551318042632;2378.37487520979,0.278894988890655,0.355484724616424;2384.32081239781,0.278550027979194,0.355417707728063;2390.28161442881,0.278205965419579,0.355350268237744;2396.25731846488,0.277862800723742,0.355282407017451;2402.24796176104,0.277520533393654,0.355214124950912;2408.25358166544,0.277179162921369,0.355145422933532;2414.27421561961,0.276838688789068,0.355076301872346;2420.30990115865,0.276499110469104,0.355006762685961;2426.36067591155,0.276160427424043,0.354936806304495;2432.42657760133,0.275822639106713,0.354866433669524;2438.50764404533,0.275485744960246,0.354795645734022;2444.60391315545,0.275149744418125,0.354724443462299;2450.71542293833,0.274814636904222,0.354652827829947;2456.84221149568,0.274480421832851,0.354580799823778;2462.98431702442,0.274147098608808,0.354508360441759;2469.14177781698,0.273814666627414,0.354435510692958;2475.31463226152,0.273483125274565,0.354362251597477;2481.50291884218,0.273152473926772,0.354288584186391;2487.70667613928,0.272822711951206,0.354214509501685;2493.92594282963,0.272493838705747,0.354140028596193;2500.16075768670,0.272165853539025,0.354065142533530;2506.41115958092,0.271838755790465,0.353989852388030;2512.67718747987,0.271512544790335,0.353914159244680;2518.95888044857,0.271187219859786,0.353838064199055;2525.25627764969,0.270862780310903,0.353761568357253;2531.56941834382,0.270539225446744,0.353684672835826;2537.89834188968,0.270216554561389,0.353607378761714;2544.24308774440,0.269894766939986,0.353529687272179;2550.60369546376,0.269573861858793,0.353451599514737;2556.98020470242,0.269253838585224,0.353373116647085;2563.37265521418,0.268934696377897,0.353294239837041;2569.78108685221,0.268616434486673,0.353214970262464;2576.20553956934,0.268299052152713,0.353135309111194;2582.64605341827,0.267982548608508,0.353055257580976;2589.10266855181,0.267666923077939,0.352974816879390;2595.57542522319,0.267352174776314,0.352893988223784;2602.06436378625,0.267038302910413,0.352812772841199;2608.56952469571,0.266725306678540,0.352731171968296;2615.09094850745,0.266413185270565,0.352649186851288;2621.62867587872,0.266101937867967,0.352566818745866;2628.18274756842,0.265791563643886,0.352484068917125;2634.75320443734,0.265482061763160,0.352400938639493;2641.34008744843,0.265173431382383,0.352317429196652;2647.94343766705,0.264865671649939,0.352233541881473;2654.56329626122,0.264558781706054,0.352149277995935;2661.19970450187,0.264252760682842,0.352064638851051;2667.85270376313,0.263947607704349,0.351979625766799;2674.52233552254,0.263643321886600,0.351894240072037;2681.20864136134,0.263339902337645,0.351808483104437;2687.91166296475,0.263037348157607,0.351722356210405;2694.63144212216,0.262735658438723,0.351635860745003;2701.36802072746,0.262434832265397,0.351548998071878;2708.12144077928,0.262134868714238,0.351461769563182;2714.89174438123,0.261835766854117,0.351374176599494;2721.67897374218,0.261537525746203,0.351286220569747;2728.48317117654,0.261240144444016,0.351197902871148;2735.30437910448,0.260943621993469,0.351109224909101;2742.14264005224,0.260647957432918,0.351020188097130;2748.99799665237,0.260353149793206,0.350930793856799;2755.87049164400,0.260059198097712,0.350841043617638;2762.76016787311,0.259766101362393,0.350750938817059;2769.66706829279,0.259473858595836,0.350660480900283;2776.59123596353,0.259182468799299,0.350569671320259;2783.53271405343,0.258891930966763,0.350478511537584;2790.49154583857,0.258602244084973,0.350387003020425;2797.46777470316,0.258313407133493,0.350295147244441;2804.46144413992,0.258025419084741,0.350202945692703;2811.47259775027,0.257738278904044,0.350110399855613;2818.50127924465,0.257451985549685,0.350017511230825;2825.54753244276,0.257166537972942,0.349924281323169;2832.61140127387,0.256881935118144,0.349830711644566;2839.69292977705,0.256598175922713,0.349736803713949;2846.79216210149,0.256315259317208,0.349642559057187;2853.90914250675,0.256033184225379,0.349547979207001;2861.04391536301,0.255751949564205,0.349453065702885;2868.19652515142,0.255471554243950,0.349357820091025;2875.36701646430,0.255191997168203,0.349262243924219;2882.55543400546,0.254913277233925,0.349166338761799;2889.76182259047,0.254635393331499,0.349070106169545;2896.98622714695,0.254358344344775,0.348973547719612;2904.22869271482,0.254082129151117,0.348876664990443;2911.48926444660,0.253806746621449,0.348779459566689;2918.76798760772,0.253532195620303,0.348681933039134;2926.06490757674,0.253258475005865,0.348584087004608;2933.38006984568,0.252985583630019,0.348485923065909;2940.71352002029,0.252713520338400,0.348387442831724;2948.06530382034,0.252442283970435,0.348288647916544;2955.43546707990,0.252171873359391,0.348189539940587;2962.82405574760,0.251902287332424,0.348090120529717;2970.23111588696,0.251633524710623,0.347990391315361;2977.65669367668,0.251365584309057,0.347890353934433;2985.10083541087,0.251098464936821,0.347790010029247;2992.56358749940,0.250832165397086,0.347689361247441;3000.04499646815,0.250566684487140,0.347588409241898;3007.54510895932,0.250302020998441,0.347487155670660;3015.06397173172,0.250038173716655,0.347385602196853;3022.60163166105,0.249775141421714,0.347283750488602;3030.15813574020,0.249512922887849,0.347181602218957;3037.73353107955,0.249251516883646,0.347079159065805;3045.32786490725,0.248990922172090,0.346976422711798;3052.94118456952,0.248731137510610,0.346873394844266;3060.57353753094,0.248472161651125,0.346770077155142;3068.22497137477,0.248213993340091,0.346666471340881;3075.89553380320,0.247956631318549,0.346562579102378;3083.58527263771,0.247700074322167,0.346458402144892;3091.29423581931,0.247444321081288,0.346353942177964;3099.02247140885,0.247189370320979,0.346249200915339;3106.77002758738,0.246935220761072,0.346144180074887;3114.53695265634,0.246681871116213,0.346038881378522;3122.32329503798,0.246429320095904,0.345933306552127;3130.12910327558,0.246177566404556,0.345827457325469;3137.95442603377,0.245926608741528,0.345721335432129;3145.79931209885,0.245676445801174,0.345614942609414;3153.66381037910,0.245427076272892,0.345508280598287;3161.54796990505,0.245178498841165,0.345401351143283;3169.45183982981,0.244930712185608,0.345294155992436;3177.37546942938,0.244683714981016,0.345186696897196;3185.31890810296,0.244437505897406,0.345078975612357;3193.28220537321,0.244192083600063,0.344970993895972;3201.26541088665,0.243947446749585,0.344862753509286;3209.26857441386,0.243703594001930,0.344754256216651;3217.29174584990,0.243460524008459,0.344645503785450;3225.33497521452,0.243218235415981,0.344536497986024;3233.39831265256,0.242976726866798,0.344427240591594;3241.48180843419,0.242735996998752,0.344317733378182;3249.58551295528,0.242496044445264,0.344207978124542;3257.70947673766,0.242256867835385,0.344097976612074;3265.85375042951,0.242018465793837,0.343987730624758;3274.01838480558,0.241780836941060,0.343877241949073;3282.20343076759,0.241543979893251,0.343766512373926;3290.40893934451,0.241307893262413,0.343655543690572;3298.63496169287,0.241072575656398,0.343544337692544;3306.88154909711,0.240838025678952,0.343432896175577;3315.14875296985,0.240604241929754,0.343321220937533;3323.43662485227,0.240371223004467,0.343209313778329;3331.74521641440,0.240138967494777,0.343097176499861;3340.07457945544,0.239907473988437,0.342984810905932;3348.42476590408,0.239676741069312,0.342872218802181;3356.79582781884,0.239446767317421,0.342759401996006;3365.18781738838,0.239217551308983,0.342646362296494;3373.60078693186,0.238989091616454,0.342533101514348;3382.03478889919,0.238761386808579,0.342419621461815;3390.48987587143,0.238534435450427,0.342305923952615;3398.96610056111,0.238308236103437,0.342192010801870;3407.46351581251,0.238082787325462,0.342077883826028;3415.98217460205,0.237858087670811,0.341963544842799;3424.52213003855,0.237634135690287,0.341848995671081;3433.08343536365,0.237410929931237,0.341734238130888;3441.66614395206,0.237188468937590,0.341619274043283;3450.27030931194,0.236966751249898,0.341504105230307;3458.89598508521,0.236745775405378,0.341388733514909;3467.54322504793,0.236525539937961,0.341273160720879;3476.21208311055,0.236306043378323,0.341157388672775;3484.90261331832,0.236087284253933,0.341041419195858;3493.61486985161,0.235869261089095,0.340925254116024;3502.34890702625,0.235651972404986,0.340808895259734;3511.10477929381,0.235435416719700,0.340692344453945;3519.88254124205,0.235219592548288,0.340575603526049;3528.68224759515,0.235004498402797,0.340458674303798;3537.50395321414,0.234790132792315,0.340341558615244;3546.34771309718,0.234576494223009,0.340224258288667;3555.21358237992,0.234363581198167,0.340106775152513;3564.10161633587,0.234151392218236,0.339989111035328;3573.01187037671,0.233939925780865,0.339871267765690;3581.94440005265,0.233729180380944,0.339753247172146;3590.89926105278,0.233519154510644,0.339635051083146;3599.87650920541,0.233309846659456,0.339516681326980;3608.87620047843,0.233101255314234,0.339398139731712;3617.89839097962,0.232893378959231,0.339279428125119;3626.94313695707,0.232686216076139,0.339160548334625;3636.01049479946,0.232479765144132,0.339041502187237;3645.10052103646,0.232274024639899,0.338922291509486;3654.21327233905,0.232068993037688,0.338802918127363;3663.34880551990,0.231864668809344,0.338683383866253;3672.50717753370,0.231661050424346,0.338563690550881;3681.68844547753,0.231458136349846,0.338443840005242;3690.89266659123,0.231255925050711,0.338323834052545;3700.11989825770,0.231054414989556,0.338203674515154;3709.37019800335,0.230853604626784,0.338083363214521;3718.64362349836,0.230653492420627,0.337962901971131;3727.94023255710,0.230454076827179,0.337842292604442;3737.26008313849,0.230255356300438,0.337721536932823;3746.60323334634,0.230057329292342,0.337600636773496;3755.96974142971,0.229859994252804,0.337479593942479;3765.35966578328,0.229663349629753,0.337358410254527;3774.77306494774,0.229467393869170,0.337237087523070;3784.20999761011,0.229272125415123,0.337115627560161;3793.67052260413,0.229077542709807,0.336994032176417;3803.15469891064,0.228883644193578,0.336872303180959;3812.66258565792,0.228690428304990,0.336750442381358;3822.19424212206,0.228497893480834,0.336628451583579;3831.74972772737,0.228306038156170,0.336506332591923;3841.32910204669,0.228114860764365,0.336384087208975;3850.93242480180,0.227924359737131,0.336261717235545;3860.55975586381,0.227734533504557,0.336139224470612;3870.21115525347,0.227545380495147,0.336016610711276;3879.88668314160,0.227356899135855,0.335893877752698;3889.58639984945,0.227169087852120,0.335771027388046;3899.31036584908,0.226981945067899,0.335648061408446;3909.05864176370,0.226795469205709,0.335524981602924;3918.83128836811,0.226609658686653,0.335401789758356;3928.62836658903,0.226424511930460,0.335278487659415;3938.44993750550,0.226240027355519,0.335155077088518;3948.29606234926,0.226056203378910,0.335031559825776;3958.16680250514,0.225873038416443,0.334907937648939;3968.06221951140,0.225690530882689,0.334784212333349;3977.98237506018,0.225508679191016,0.334660385651887;3987.92733099783,0.225327481753618,0.334536459374925;3997.89714932532,0.225146936981557,0.334412435270269;4007.89189219864,0.224967043284788,0.334288315103121;4017.91162192913,0.224787799072195,0.334164100636017;4027.95640098396,0.224609202751628,0.334039793628789;4038.02629198642,0.224431252729931,0.333915395838506;4048.12135771638,0.224253947412976,0.333790909019437;4058.24166111067,0.224077285205699,0.333666334922991;4068.38726526345,0.223901264512126,0.333541675297680;4078.55823342661,0.223725883735412,0.333416931889065;4088.75462901017,0.223551141277870,0.333292106439712;4098.97651558270,0.223377035541002,0.333167200689144;4109.22395687165,0.223203564925535,0.333042216373795;4119.49701676383,0.223030727831448,0.332917155226965;4129.79575930574,0.222858522658005,0.332792018978774;4140.12024870401,0.222686947803790,0.332666809356117;4150.47054932577,0.222516001666733,0.332541528082617;4160.84672569908,0.222345682644143,0.332416176878583;4171.24884251333,0.222175989132745,0.332290757460967;4181.67696461961,0.222006919528698,0.332165271543316;4192.13115703116,0.221838472227638,0.332039720835731;4202.61148492374,0.221670645624701,0.331914107044824;4213.11801363605,0.221503438114559,0.331788431873674;4223.65080867014,0.221336848091444,0.331662697021786;4234.20993569181,0.221170873949185,0.331536904185047;4244.79546053104,0.221005514081231,0.331411055055686;4255.40744918237,0.220840766880686,0.331285151322230;4266.04596780532,0.220676630740337,0.331159194669468;4276.71108272484,0.220513104052682,0.331033186778404;4287.40286043165,0.220350185209962,0.330907129326219;4298.12136758273,0.220187872604188,0.330781023986232;4308.86667100168,0.220026164627173,0.330654872427860;4319.63883767919,0.219865059670555,0.330528676316576;4330.43793477339,0.219704556125834,0.330402437313873;4341.26402961032,0.219544652384394,0.330276157077224;4352.11718968434,0.219385346837535,0.330149837260043;4362.99748265855,0.219226637876499,0.330023479511646;4373.90497636520,0.219068523892500,0.329897085477216;4384.83973880611,0.218911003276752,0.329770656797763;4395.80183815313,0.218754074420495,0.329644195110089;4406.79134274851,0.218597735715026,0.329517702046749;4417.80832110538,0.218441985551725,0.329391179236013;4428.85284190815,0.218286822322081,0.329264628301838;4439.92497401292,0.218132244417720,0.329138050863820;4451.02478644795,0.217978250230435,0.329011448537170;4462.15234841407,0.217824838152211,0.328884822932669;4473.30772928510,0.217672006575251,0.328758175656643;4484.49099860832,0.217519753892004,0.328631508310917;4495.70222610484,0.217368078495192,0.328504822492793;4506.94148167010,0.217216978777835,0.328378119795005;4518.20883537427,0.217066453133281,0.328251401805695;4529.50435746271,0.216916499955227,0.328124670108370;4540.82811835636,0.216767117637749,0.327997926281880;4552.18018865226,0.216618304575327,0.327871171900374;4563.56063912389,0.216470059162871,0.327744408533277;4574.96954072170,0.216322379795745,0.327617637745254;4586.40696457350,0.216175264869797,0.327490861096176;4597.87298198493,0.216028712781379,0.327364080141094;4609.36766443989,0.215882721927376,0.327237296430204;4620.89108360099,0.215737290705230,0.327110511508818;4632.44331131000,0.215592417512966,0.326983726917331;4644.02441958827,0.215448100749214,0.326856944191197;4655.63448063724,0.215304338813239,0.326730164860891;4667.27356683883,0.215161130104960,0.326603390451886;4678.94175075593,0.215018473024980,0.326476622484621;4690.63910513282,0.214876365974604,0.326349862474472;4702.36570289565,0.214734807355870,0.326223111931726;4714.12161715289,0.214593795571571,0.326096372361549;4725.90692119577,0.214453329025275,0.325969645263960;4737.72168849876,0.214313406121354,0.325842932133806;4749.56599272001,0.214174025265006,0.325716234460728;4761.43990770181,0.214035184862279,0.325589553729141;4773.34350747107,0.213896883320094,0.325462891418204;4785.27686623974,0.213759119046268,0.325336249001793;4797.24005840534,0.213621890449539,0.325209627948478;4809.23315855135,0.213485195939587,0.325083029721493;4821.25624144773,0.213349033927061,0.324956455778713;4833.30938205135,0.213213402823595,0.324829907572629;4845.39265550648,0.213078301041838,0.324703386550325;4857.50613714525,0.212943726995473,0.324576894153446;4869.64990248811,0.212809679099240,0.324450431818184;4881.82402724433,0.212676155768960,0.324324000975247;4894.02858731244,0.212543155421555,0.324197603049837;4906.26365878072,0.212410676475071,0.324071239461627;4918.52931792767,0.212278717348702,0.323944911624738;4930.82564122249,0.212147276462809,0.323818620947717;4943.15270532555,0.212016352238943,0.323692368833514;4955.51058708886,0.211885943099870,0.323566156679457;4967.89936355658,0.211756047469586,0.323439985877237;4980.31911196547,0.211626663773345,0.323313857812879;4992.76990974539,0.211497790437675,0.323187773866726;5005.25183451975,0.211369425890405,0.323061735413413;5017.76496410605,0.211241568560681,0.322935743821854;5030.30937651631,0.211114216878990,0.322809800455213;5042.88514995760,0.210987369277180,0.322683906670890;5055.49236283250,0.210861024188481,0.322558063820499;5068.13109373958,0.210735180047525,0.322432273249848;5080.80142147393,0.210609835290368,0.322306536298922;5093.50342502761,0.210484988354509,0.322180854301862;5106.23718359018,0.210360637678913,0.322055228586946;5119.00277654916,0.210236781704027,0.321929660476573;5131.80028349053,0.210113418871805,0.321804151287244;5144.62978419925,0.209990547625723,0.321678702329542;5157.49135865975,0.209868166410802,0.321553314908121;5170.38508705640,0.209746273673630,0.321427990321680;5183.31104977404,0.209624867862377,0.321302729862952;5196.26932739848,0.209503947426816,0.321177534818688;5209.26000071697,0.209383510818343,0.321052406469636;5222.28315071877,0.209263556490000,0.320927346090530;5235.33885859556,0.209144082896486,0.320802354950071;5248.42720574205,0.209025088494185,0.320677434310914;5261.54827375641,0.208906571741177,0.320552585429650;5274.70214444080,0.208788531097266,0.320427809556794;5287.88889980190,0.208670965023988,0.320303107936769;5301.10862205140,0.208553871984640,0.320178481807892;5314.36139360653,0.208437250444292,0.320053932402360;5327.64729709055,0.208321098869808,0.319929460946237;5340.96641533327,0.208205415729863,0.319805068659438;5354.31883137161,0.208090199494965,0.319680756755720;5367.70462845003,0.207975448637467,0.319556526442667;5381.12389002116,0.207861161631592,0.319432378921676;5394.57669974621,0.207747336953443,0.319308315387947;5408.06314149558,0.207633973081031,0.319184337030471;5421.58329934932,0.207521068494282,0.319060445032015;5435.13725759769,0.207408621675063,0.318936640569116;5448.72510074168,0.207296631107194,0.318812924812066;5462.34691349354,0.207185095276470,0.318689298924901;5476.00278077727,0.207074012670673,0.318565764065392;5489.69278772921,0.206963381779596,0.318442321385035;5503.41701969853,0.206853201095053,0.318318972029039;5517.17556224778,0.206743469110902,0.318195717136319;5530.96850115340,0.206634184323057,0.318072557839484;5544.79592240628,0.206525345229508,0.317949495264827;5558.65791221230,0.206416950330337,0.317826530532321;5572.55455699283,0.206308998127734,0.317703664755606;5586.48594338531,0.206201487126013,0.317580899041980;5600.45215824377,0.206094415831632,0.317458234492395;5614.45328863938,0.205987782753202,0.317335672201447;5628.48942186098,0.205881586401510,0.317213213257366;5642.56064541563,0.205775825289533,0.317090858742014;5656.66704702917,0.205670497932454,0.316968609730873;5670.80871464675,0.205565602847675,0.316846467293041;5684.98573643336,0.205461138554836,0.316724432491225;5699.19820077445,0.205357103575831,0.316602506381735;5713.44619627638,0.205253496434821,0.316480690014479;5727.72981176707,0.205150315658252,0.316358984432953;5742.04913629649,0.205047559774867,0.316237390674241;5756.40425913723,0.204945227315724,0.316115909769008;5770.79526978507,0.204843316814211,0.315994542741494;5785.22225795954,0.204741826806060,0.315873290609510;5799.68531360443,0.204640755829361,0.315752154384437;5814.18452688844,0.204540102424579,0.315631135071214;5828.71998820567,0.204439865134568,0.315510233668343;5843.29178817618,0.204340042504584,0.315389451167882;5857.90001764662,0.204240633082301,0.315268788555438;5872.54476769074,0.204141635417825,0.315148246810171;5887.22612960996,0.204043048063709,0.315027826904786;5901.94419493399,0.203944869574966,0.314907529805534;5916.69905542132,0.203847098509081,0.314787356472207;5931.49080305987,0.203749733426032,0.314667307858137;5946.31953006752,0.203652772888295,0.314547384910195;5961.18532889269,0.203556215460864,0.314427588568789;5976.08829221492,0.203460059711261,0.314307919767865;5991.02851294546,0.203364304209554,0.314188379434901;6006.00608422782,0.203268947528364,0.314068968490912;6021.02109943839,0.203173988242883,0.313949687850447;6036.07365218699,0.203079424930885,0.313830538421588;6051.16383631746,0.202985256172743,0.313711521105952;6066.29174590825,0.202891480551435,0.313592636798690;6081.45747527302,0.202798096652563,0.313473886388489;6096.66111896120,0.202705103064363,0.313355270757573;6111.90277175860,0.202612498377718,0.313236790781702;6127.18252868800,0.202520281186171,0.313118447330174;6142.50048500972,0.202428450085938,0.313000241265830;6157.85673622224,0.202337003675917,0.312882173445052;6173.25137806280,0.202245940557706,0.312764244717766;6188.68450650796,0.202155259335608,0.312646455927446;6204.15621777422,0.202064958616650,0.312528807911115;6219.66660831866,0.201975037010591,0.312411301499349;6235.21577483946,0.201885493129934,0.312293937516278;6250.80381427655,0.201796325589937,0.312176716779595;6266.43082381224,0.201707533008629,0.312059640100550;6282.09690087177,0.201619114006815,0.311942708283966;6297.80214312395,0.201531067208092,0.311825922128231;6313.54664848176,0.201443391238858,0.311709282425311;6329.33051510297,0.201356084728326,0.311592789960752;6345.15384139072,0.201269146308531,0.311476445513683;6361.01672599420,0.201182574614343,0.311360249856824;6376.91926780919,0.201096368283478,0.311244203756488;6392.86156597871,0.201010525956510,0.311128307972592;6408.84371989365,0.200925046276877,0.311012563258656;6424.86582919339,0.200839927890896,0.310896970361813;6440.92799376637,0.200755169447774,0.310781530022815;6457.03031375079,0.200670769599612,0.310666242976041;6473.17288953516,0.200586727001423,0.310551109949498;6489.35582175900,0.200503040311135,0.310436131664834;6505.57921131340,0.200419708189607,0.310321308837344;6521.84315934168,0.200336729300634,0.310206642175974;6538.14776724003,0.200254102310961,0.310092132383332;6554.49313665813,0.200171825890290,0.309977780155696;6570.87936949978,0.200089898711287,0.309863586183019;6587.30656792353,0.200008319449597,0.309749551148940;6603.77483434334,0.199927086783852,0.309635675730793;6620.28427142919,0.199846199395674,0.309521960599612;6636.83498210777,0.199765655969693,0.309408406420146;6653.42706956304,0.199685455193550,0.309295013850862;6670.06063723694,0.199605595757909,0.309181783543958;6686.73578883004,0.199526076356461,0.309068716145372;6703.45262830211,0.199446895685940,0.308955812294790;6720.21125987287,0.199368052446124,0.308843072625662;6737.01178802255,0.199289545339849,0.308730497765202;6753.85431749260,0.199211373073014,0.308618088334409;6770.73895328633,0.199133534354592,0.308505844948071;6787.66580066955,0.199056027896633,0.308393768214780;6804.63496517122,0.198978852414279,0.308281858736938;6821.64655258415,0.198902006625764,0.308170117110773;6838.70066896561,0.198825489252430,0.308058543926351;6855.79742063802,0.198749299018727,0.307947139767582;6872.93691418962,0.198673434652227,0.307835905212238;6890.11925647509,0.198597894883627,0.307724840831963;6907.34455461628,0.198522678446755,0.307613947192282;6924.61291600282,0.198447784078585,0.307503224852621;6941.92444829283,0.198373210519235,0.307392674366311;6959.27925941356,0.198298956511980,0.307282296280608;6976.67745756209,0.198225020803253,0.307172091136702;6994.11915120600,0.198151402142660,0.307062059469733;7011.60444908401,0.198078099282979,0.306952201808801;7029.13346020672,0.198005110980171,0.306842518676983;7046.70629385724,0.197932435993385,0.306733010591346;7064.32305959188,0.197860073084962,0.306623678062959;7081.98386724086,0.197788021020446,0.306514521596912;7099.68882690896,0.197716278568586,0.306405541692323;7117.43804897623,0.197644844501343,0.306296738842361;7135.23164409867,0.197573717593898,0.306188113534253;7153.06972320892,0.197502896624654,0.306079666249306;7170.95239751694,0.197432380375245,0.305971397462917;7188.87977851073,0.197362167630539,0.305863307644591;7206.85197795701,0.197292257178646,0.305755397257954;7224.86910790190,0.197222647810919,0.305647666760773;7242.93128067166,0.197153338321965,0.305540116604965;7261.03860887333,0.197084327509645,0.305432747236621;7279.19120539552,0.197015614175083,0.305325559096016;7297.38918340901,0.196947197122666,0.305218552617629;7315.63265636753,0.196879075160054,0.305111728230157;7333.92173800845,0.196811247098181,0.305005086356532;7352.25654235347,0.196743711751261,0.304898627413942;7370.63718370935,0.196676467936793,0.304792351813840;7389.06377666862,0.196609514475563,0.304686259961969;7407.53643611029,0.196542850191650,0.304580352258375;7426.05527720057,0.196476473912431,0.304474629097424;7444.62041539357,0.196410384468582,0.304369090867823;7463.23196643205,0.196344580694085,0.304263737952636;7481.89004634813,0.196279061426229,0.304158570729299;7500.59477146400,0.196213825505616,0.304053589569644;7519.34625839266,0.196148871776163,0.303948794839912;7538.14462403864,0.196084199085107,0.303844186900774;7556.98998559874,0.196019806283005,0.303739766107348;7575.88246056274,0.195955692223743,0.303635532809218;7594.82216671414,0.195891855764532,0.303531487350457;7613.80922213093,0.195828295765917,0.303427630069636;7632.84374518626,0.195765011091777,0.303323961299855;7651.92585454922,0.195702000609329,0.303220481368752;7671.05566918559,0.195639263189128,0.303117190598529;7690.23330835856,0.195576797705073,0.303014089305968;7709.45889162945,0.195514603034408,0.302911177802452;7728.73253885853,0.195452678057726,0.302808456393985;7748.05437020567,0.195391021658967,0.302705925381209;7767.42450613119,0.195329632725424,0.302603585059429;7786.84306739651,0.195268510147744,0.302501435718628;7806.31017506500,0.195207652819931,0.302399477643490;7825.82595050267,0.195147059639346,0.302297711113420;7845.39051537892,0.195086729506708,0.302196136402563;7865.00399166737,0.195026661326099,0.302094753779828;7884.66650164654,0.194966854004964,0.301993563508904;7904.37816790065,0.194907306454111,0.301892565848284;7924.13911332041,0.194848017587712,0.301791761051285;7943.94946110371,0.194788986323311,0.301691149366068;7963.80933475647,0.194730211581813,0.301590731035662;7983.71885809336,0.194671692287497,0.301490506297981;8003.67815523859,0.194613427368009,0.301390475385848;8023.68735062669,0.194555415754368,0.301290638527018;8043.74656900325,0.194497656380962,0.301190995944195;8063.85593542576,0.194440148185552,0.301091547855056;8084.01557526432,0.194382890109272,0.300992294472276;8104.22561420248,0.194325881096628,0.300893236003542;8124.48617823799,0.194269120095499,0.300794372651582;8144.79739368358,0.194212606057139,0.300695704614183;8165.15938716779,0.194156337936175,0.300597232084217;8185.57228563571,0.194100314690606,0.300498955249658;8206.03621634980,0.194044535281807,0.300400874293607;8226.55130689067,0.193988998674526,0.300302989394315;8247.11768515790,0.193933703836883,0.300205300725205;8267.73547937079,0.193878649740371,0.300107808454891;8288.40481806922,0.193823835359857,0.300010512747208;8309.12583011439,0.193769259673578,0.299913413761227;8329.89864468968,0.193714921663143,0.299816511651282;8350.72339130140,0.193660820313531,0.299719806566990;8371.60019977966,0.193606954613092,0.299623298653278;8392.52920027911,0.193553323553543,0.299526988050401;8413.51052327980,0.193499926129970,0.299430874893970;8434.54429958800,0.193446761340826,0.299334959314971;8455.63066033697,0.193393828187926,0.299239241439789;8476.76973698781,0.193341125676454,0.299143721390231;8497.96166133028,0.193288652814953,0.299048399283554;8519.20656548361,0.193236408615331,0.298953275232479;8540.50458189732,0.193184392092851,0.298858349345224;8561.85584335206,0.193132602266139,0.298763621725520;8583.26048296044,0.193081038157172,0.298669092472639;8604.71863416784,0.193029698791288,0.298574761681416;8626.23043075326,0.192978583197171,0.298480629442272;8647.79600683014,0.192927690406861,0.298386695841238;8669.41549684721,0.192877019455743,0.298292960959979;8691.08903558933,0.192826569382550,0.298199424875818;8712.81675817830,0.192776339229359,0.298106087661760;8734.59880007375,0.192726328041588,0.298012949386512;8756.43529707393,0.192676534867995,0.297920010114514;8778.32638531662,0.192626958760675,0.297827269905955;8800.27220127991,0.192577598775056,0.297734728816804;8822.27288178311,0.192528453969899,0.297642386898827;8844.32856398756,0.192479523407293,0.297550244199619;8866.43938539753,0.192430806152654,0.297458300762619;8888.60548386102,0.192382301274718,0.297366556627141;8910.82699757068,0.192334007845545,0.297275011828397;8933.10406506460,0.192285924940509,0.297183666397516;8955.43682522726,0.192238051638298,0.297092520361575;8977.82541729033,0.192190387020913,0.297001573743619;9000.26998083355,0.192142930173658,0.296910826562686;9022.77065578564,0.192095680185145,0.296820278833832;9045.32758242510,0.192048636147283,0.296729930568153;9067.94090138116,0.192001797155280,0.296639781772813;9090.61075363462,0.191955162307635,0.296549832451063;9113.33728051870,0.191908730706139,0.296460082602272;9136.12062372000,0.191862501455866,0.296370532221944;9158.96092527930,0.191816473665172,0.296281181301747;9181.85832759249,0.191770646445693,0.296192029829537;9204.81297341148,0.191725018912336,0.296103077789380;9227.82500584500,0.191679590183280,0.296014325161577;9250.89456835962,0.191634359379968,0.295925771922692;9274.02180478051,0.191589325627104,0.295837418045570;9297.20685929246,0.191544488052651,0.295749263499366;9320.44987644069,0.191499845787823,0.295661308249566;9343.75100113180,0.191455397967083,0.295573552258015;9367.11037863462,0.191411143728136,0.295485995482939;9390.52815458121,0.191367082211928,0.295398637878970;9414.00447496766,0.191323212562640,0.295311479397168;9437.53948615508,0.191279533927681,0.295224519985049;9461.13333487047,0.191236045457686,0.295137759586607;9484.78616820765,0.191192746306509,0.295051198142339;9508.49813362816,0.191149635631220,0.294964835589268;9532.26937896223,0.191106712592101,0.294878671860969;9556.10005240964,0.191063976352635,0.294792706887594;9579.99030254066,0.191021426079510,0.294706940595890;9603.94027829701,0.190979060942606,0.294621372909234;9627.95012899276,0.190936880114993,0.294536003747645;9652.02000431524,0.190894882772926,0.294450833027819;9676.15005432602,0.190853068095839,0.294365860663146;9700.34042946184,0.190811435266339,0.294281086563736;9724.59128053549,0.190769983470203,0.294196510636444;9748.90275873683,0.190728711896368,0.294112132784894;9773.27501563367,0.190687619736932,0.294027952909502;9797.70820317276,0.190646706187139,0.293943970907502;9822.20247368069,0.190605970445385,0.293860186672965;9846.75797986489,0.190565411713200,0.293776600096831;9871.37487481455,0.190525029195254,0.293693211066925;9896.05331200159,0.190484822099340,0.293610019467985;9920.79344528159,0.190444789636375,0.293527025181687;9945.59542889480,0.190404931020396,0.293444228086665;9970.45941746703,0.190365245468545,0.293361628058537;9995.38556601070,0.190325732201073,0.293279224969929;10020.3740299257,0.190286390441324,0.293197018690498;10045.4249650005,0.190247219415740,0.293115009086956;10070.5385274130,0.190208218353843,0.293033196023093;10095.7148737316,0.190169386488238,0.292951579359801;10120.9541609159,0.190130723054602,0.292870158955099;10146.2565463182,0.190092227291679,0.292788934664152;10171.6221876840,0.190053898441273,0.292707906339301;10197.0512431532,0.190015735748240,0.292627073830080;10222.5438712611,0.189977738460488,0.292546436983245;10248.1002309392,0.189939905828960,0.292465995642793;10273.7204815166,0.189902237107638,0.292385749649987;10299.4047827204,0.189864731553526,0.292305698843378;10325.1532946772,0.189827388426655,0.292225843058831;10350.9661779139,0.189790206990063,0.292146182129546;10376.8435933586,0.189753186509801,0.292066715886081;10402.7857023420,0.189716326254917,0.291987444156375;10428.7926665979,0.189679625497453,0.291908366765772;10454.8646482644,0.189643083512437,0.291829483537042;10481.0018098850,0.189606699577878,0.291750794290406;10507.2043144098,0.189570472974755,0.291672298843558;10533.4723251958,0.189534402987015,0.291593997011686;10559.8060060088,0.189498488901562,0.291515888607499;10586.2055210238,0.189462730008250,0.291437973441243;10612.6710348264,0.189427125599878,0.291360251320730;10639.2027124134,0.189391674972182,0.291282722051356;10665.8007191945,0.189356377423828,0.291205385436127;10692.4652209924,0.189321232256403,0.291128241275677;10719.1963840449,0.189286238774410,0.291051289368294;10745.9943750050,0.189251396285259,0.290974529509943;10772.8593609425,0.189216704099260,0.290897961494281;10799.7915093449,0.189182161529615,0.290821585112689;10826.7909881183,0.189147767892415,0.290745400154286;10853.8579655886,0.189113522506624,0.290669406405956;10880.9926105025,0.189079424694079,0.290593603652366;10908.1950920288,0.189045473779481,0.290517991675992;10935.4655797589,0.189011669090382,0.290442570257136;10962.8042437082,0.188978009957187,0.290367339173951;10990.2112543175,0.188944495713136,0.290292298202463;11017.6867824533,0.188911125694304,0.290217447116588;11045.2309994094,0.188877899239591,0.290142785688160;11072.8440769080,0.188844815690713,0.290068313686947;11100.5261871002,0.188811874392194,0.289994030880673;11128.2775025680,0.188779074691361,0.289919937035043;11156.0981963244,0.188746415938334,0.289846031913760;11183.9884418152,0.188713897486020,0.289772315278548;11211.9484129198,0.188681518690101,0.289698786889171;11239.9782839521,0.188649278909032,0.289625446503458;11268.0782296619,0.188617177504029,0.289552293877318;11296.2484252361,0.188585213839061,0.289479328764767;11324.4890462992,0.188553387280845,0.289406550917944;11352.8002689149,0.188521697198836,0.289333960087132;11381.1822695872,0.188490142965217,0.289261556020782;11409.6352252612,0.188458723954897,0.289189338465529;11438.1593133243,0.188427439545497,0.289117307166214;11466.7547116076,0.188396289117344,0.289045461865907;11495.4215983867,0.188365272053464,0.288973802305922;11524.1601523826,0.188334387739573,0.288902328225842;11552.9705527636,0.188303635564068,0.288831039363534;11581.8529791455,0.188273014918021,0.288759935455174;11610.8076115934,0.188242525195168,0.288689016235264;11639.8346306223,0.188212165791905,0.288618281436650;11668.9342171989,0.188181936107274,0.288547730790546;11698.1065527419,0.188151835542961,0.288477364026550;11727.3518191237,0.188121863503285,0.288407180872667;11756.6701986716,0.188092019395187,0.288337181055323;11786.0618741682,0.188062302628225,0.288267364299389;11815.5270288536,0.188032712614568,0.288197730328198;11845.0658464258,0.188003248768982,0.288128278863567;11874.6785110418,0.187973910508825,0.288059009625809;11904.3652073194,0.187944697254040,0.287989922333762;11934.1261203377,0.187915608427145,0.287921016704798;11963.9614356386,0.187886643453221,0.287852292454850;11993.8713392277,0.187857801759913,0.287783749298423;12023.8560175758,0.187829082777410,0.287715386948620;12053.9156576197,0.187800485938448,0.287647205117154;12084.0504467637,0.187772010678294,0.287579203514371;12114.2605728807,0.187743656434740,0.287511381849267;12144.5462243129,0.187715422648094,0.287443739829505;12174.9075898736,0.187687308761173,0.287376277161432;12205.3448588483,0.187659314219296,0.287308993550102;12235.8582209954,0.187631438470269,0.287241888699289;12266.4478665479,0.187603680964383,0.287174962311507;12297.1139862143,0.187576041154406,0.287108214088028;12327.8567711798,0.187548518495569,0.287041643728898;12358.6764131078,0.187521112445562,0.286975250932955;12389.5731041405,0.187493822464523,0.286909035397849;12420.5470369009,0.187466648015035,0.286842996820056;12451.5984044932,0.187439588562108,0.286777134894896;12482.7274005044,0.187412643573179,0.286711449316552;12513.9342190056,0.187385812518101,0.286645939778085;12545.2190545532,0.187359094869134,0.286580605971452;12576.5821021895,0.187332490100934,0.286515447587523;12608.0235574450,0.187305997690551,0.286450464316098;12639.5436163386,0.187279617117415,0.286385655845921;12671.1424753795,0.187253347863329,0.286321021864700;12702.8203315679,0.187227189412461,0.286256562059124;12734.5773823968,0.187201141251336,0.286192276114875;12766.4138258528,0.187175202868827,0.286128163716647;12798.3298604175,0.187149373756146,0.286064224548164;12830.3256850685,0.187123653406836,0.286000458292193;12862.4014992812,0.187098041316764,0.285936864630562;12894.5575030294,0.187072536984107,0.285873443244175;12926.7938967869,0.187047139909354,0.285810193813028;12959.1108815289,0.187021849595286,0.285747116016224;12991.5086587327,0.186996665546975,0.285684209531991;13023.9874303796,0.186971587271773,0.285621474037694;13056.5473989555,0.186946614279304,0.285558909209854;13089.1887674529,0.186921746081454,0.285496514724162;13121.9117393715,0.186896982192368,0.285434290255493;13154.7165187200,0.186872322128432,0.285372235477922;13187.6033100168,0.186847765408274,0.285310350064740;13220.5723182918,0.186823311552753,0.285248633688468;13253.6237490875,0.186798960084944,0.285187086020872;13286.7578084602,0.186774710530139,0.285125706732977;13319.9747029814,0.186750562415834,0.285064495495085;13353.2746397388,0.186726515271720,0.285003451976783;13386.6578263382,0.186702568629677,0.284942575846966;13420.1244709040,0.186678722023763,0.284881866773844;13453.6747820813,0.186654974990208,0.284821324424961;13487.3089690365,0.186631327067404,0.284760948467207;13521.0272414591,0.186607777795897,0.284700738566830;13554.8298095627,0.186584326718379,0.284640694389458;13588.7168840866,0.186560973379680,0.284580815600102;13622.6886762969,0.186537717326760,0.284521101863179;13656.7453979876,0.186514558108697,0.284461552842520;13690.8872614826,0.186491495276683,0.284402168201388;13725.1144796363,0.186468528384016,0.284342947602485;13759.4272658354,0.186445656986087,0.284283890707974;13793.8258340000,0.186422880640377,0.284224997179486;13828.3103985850,0.186400198906444,0.284166266678136;13862.8811745814,0.186377611345918,0.284107698864533;13897.5383775179,0.186355117522494,0.284049293398800;13932.2822234617,0.186332717001917,0.283991049940578;13967.1129290203,0.186310409351983,0.283932968149045;14002.0307113429,0.186288194142522,0.283875047682928;14037.0357881212,0.186266070945398,0.283817288200514;14072.1283775915,0.186244039334493,0.283759689359663;14107.3086985355,0.186222098885703,0.283702250817821;14142.5769702818,0.186200249176933,0.283644972232033;14177.9334127075,0.186178489788080,0.283587853258954;14213.3782462393,0.186156820301033,0.283530893554862;14248.9116918549,0.186135240299661,0.283474092775669;14284.5339710845,0.186113749369807,0.283417450576936;14320.2453060123,0.186092347099276,0.283360966613881;14356.0459192773,0.186071033077831,0.283304640541394;14391.9360340755,0.186049806897184,0.283248472014048;14427.9158741607,0.186028668150987,0.283192460686108;14463.9856638461,0.186007616434823,0.283136606211548;14500.1456280057,0.185986651346202,0.283080908244056;14536.3959920757,0.185965772484546,0.283025366437051;14572.7369820559,0.185944979451190,0.282969980443692;14609.1688245110,0.185924271849366,0.282914749916889;14645.6917465723,0.185903649284200,0.282859674509313;14682.3059759387,0.185883111362700,0.282804753873411;14719.0117408786,0.185862657693754,0.282749987661411;14755.8092702308,0.185842287888114,0.282695375525340;14792.6987934064,0.185822001558397,0.282640917117029;14829.6805403899,0.185801798319069,0.282586612088126;14866.7547417408,0.185781677786444,0.282532460090107;14903.9216285952,0.185761639578668,0.282478460774284;14941.1814326667,0.185741683315722,0.282424613791821;14978.5343862483,0.185721808619404,0.282370918793735;15015.9807222140,0.185702015113327,0.282317375430919;15053.5206740195,0.185682302422909,0.282263983354138;15091.1544757045,0.185662670175367,0.282210742214051;15128.8823618938,0.185643117999706,0.282157651661215;15166.7045677985,0.185623645526716,0.282104711346095;15204.6213292180,0.185604252388958,0.282051920919076;15242.6328825411,0.185584938220764,0.281999280030470;15280.7394647474,0.185565702658222,0.281946788330530;15318.9413134093,0.185546545339174,0.281894445469455;15357.2386666928,0.185527465903205,0.281842251097401;15395.6317633596,0.185508463991634,0.281790204864492;15434.1208427680,0.185489539247513,0.281738306420827;15472.7061448749,0.185470691315611,0.281686555416491;15511.3879102371,0.185451919842414,0.281634951501563;15550.1663800126,0.185433224476112,0.281583494326126;15589.0417959627,0.185414604866593,0.281532183540277;15628.0144004526,0.185396060665437,0.281481018794130;15667.0844364537,0.185377591525908,0.281429999737834;15706.2521475449,0.185359197102945,0.281379126021574;15745.5177779137,0.185340877053155,0.281328397295585;15784.8815723585,0.185322631034807,0.281277813210156;15824.3437762894,0.185304458707824,0.281227373415643;15863.9046357301,0.185286359733775,0.281177077562472;15903.5643973194,0.185268333775867,0.281126925301154;15943.3233083127,0.185250380498941,0.281076916282289;15983.1816165835,0.185232499569459,0.281027050156574;16023.1395706250,0.185214690655502,0.280977326574812;16063.1974195515,0.185196953426761,0.280927745187921;16103.3554131004,0.185179287554528,0.280878305646941;16143.6138016332,0.185161692711692,0.280829007603042;16183.9728361372,0.185144168572728,0.280779850707532;16224.4327682276,0.185126714813694,0.280730834611864;16264.9938501482,0.185109331112219,0.280681958967644;16305.6563347735,0.185092017147500,0.280633223426640;16346.4204756105,0.185074772600293,0.280584627640787;16387.2865267995,0.185057597152907,0.280536171262196;16428.2547431165,0.185040490489194,0.280487853943162;16469.3253799743,0.185023452294547,0.280439675336169;16510.4986934242,0.185006482255886,0.280391635093899;16551.7749401578,0.184989580061661,0.280343732869239;16593.1543775082,0.184972745401832,0.280295968315287;16634.6372634519,0.184955977967873,0.280248341085362;16676.2238566106,0.184939277452761,0.280200850833004;16717.9144162521,0.184922643550969,0.280153497211991;16759.7092022927,0.184906075958457,0.280106279876335;16801.6084752984,0.184889574372669,0.280059198480299;16843.6124964867,0.184873138492525,0.280012252678394;16885.7215277279,0.184856768018413,0.279965442125393;16927.9358315472,0.184840462652183,0.279918766476334;16970.2556711261,0.184824222097138,0.279872225386526;17012.6813103039,0.184808046058032,0.279825818511557;17055.2130135797,0.184791934241059,0.279779545507300;17097.8510461136,0.184775886353847,0.279733406029919;17140.5956737289,0.184759902105455,0.279687399735875;17183.4471629132,0.184743981206358,0.279641526281931;17226.4057808205,0.184728123368451,0.279595785325160;17269.4717952726,0.184712328305034,0.279550176522950;17312.6454747607,0.184696595730810,0.279504699533009;17355.9270884476,0.184680925361876,0.279459354013374;17399.3169061688,0.184665316915715,0.279414139622412;17442.8151984342,0.184649770111196,0.279369056018829;17486.4222364303,0.184634284668560,0.279324102861676;17530.1382920213,0.184618860309418,0.279279279810351;17573.9636377514,0.184603496756743,0.279234586524609;17617.8985468458,0.184588193734862,0.279190022664563;17661.9432932129,0.184572950969454,0.279145587890694;17706.0981514459,0.184557768187540,0.279101281863852;17750.3633968245,0.184542645117475,0.279057104245264;17794.7393053166,0.184527581488948,0.279013054696539;17839.2261535799,0.184512577032970,0.278969132879669;17883.8242189638,0.184497631481868,0.278925338457043;17928.5337795112,0.184482744569283,0.278881671091441;17973.3551139600,0.184467916030158,0.278838130446048;18018.2885017449,0.184453145600737,0.278794716184454;18063.3342229993,0.184438433018556,0.278751427970659;18108.4925585568,0.184423778022437,0.278708265469080;18153.7637899532,0.184409180352480,0.278665228344554;18199.1481994280,0.184394639750061,0.278622316262344;18244.6460699266,0.184380155957825,0.278579528888141;18290.2576851014,0.184365728719677,0.278536865888071;18335.9833293142,0.184351357780777,0.278494326928700;18381.8232876375,0.184337042887534,0.278451911677034;18427.7778458565,0.184322783787605,0.278409619800529;18473.8472904712,0.184308580229878,0.278367450967092;18520.0319086974,0.184294431964477,0.278325404845085;18566.3319884691,0.184280338742751,0.278283481103331;18612.7478184403,0.184266300317267,0.278241679411116;18659.2796879864,0.184252316441806,0.278199999438196;18705.9278872063,0.184238386871358,0.278158440854797;18752.6927069244,0.184224511362115,0.278117003331624;18799.5744386917,0.184210689671462,0.278075686539859;18846.5733747884,0.184196921557977,0.278034490151170;18893.6898082254,0.184183206781423,0.277993413837713;18940.9240327459,0.184169545102740,0.277952457272134;18988.2763428278,0.184155936284040,0.277911620127574;19035.7470336849,0.184142380088605,0.277870902077674;19083.3364012690,0.184128876280876,0.277830302796578;19131.0447422722,0.184115424626451,0.277789821958933;19178.8723541279,0.184102024892078,0.277749459239899;19226.8195350132,0.184088676845649,0.277709214315146;19274.8865838508,0.184075380256194,0.277669086860861;19323.0738003104,0.184062134893879,0.277629076553752;19371.3814848112,0.184048940529994,0.277589183071048;19419.8099385232,0.184035796936954,0.277549406090505;19468.3594633695,0.184022703888290,0.277509745290407;19517.0303620279,0.184009661158643,0.277470200349572;19565.8229379330,0.183996668523761,0.277430770947353;19614.7374952778,0.183983725760490,0.277391456763641;19663.7743390160,0.183970832646774,0.277352257478869;19712.9337748636,0.183957988961643,0.277313172774014;19762.2161093007,0.183945194485213,0.277274202330600;19811.6216495740,0.183932448998677,0.277235345830703;19861.1507036979,0.183919752284304,0.277196602956950;19910.8035804572,0.183907104125428,0.277157973392525;19960.5805894083,0.183894504306446,0.277119456821170;20010.4820408818,0.183881952612815,0.277081052927188;20060.5082459840,0.183869448831040,0.277042761395447;20110.6595165990,0.183856992748675,0.277004581911379;20160.9361653905,0.183844584154317,0.276966514160988;20211.3385058039,0.183832222837596,0.276928557830847;20261.8668520685,0.183819908589178,0.276890712608104;20312.5215191986,0.183807641200749,0.276852978180483;20363.3028229966,0.183795420465023,0.276815354236287;20414.2110800541,0.183783246175723,0.276777840464399;20465.2466077542,0.183771118127589,0.276740436554287;20516.4097242736,0.183759036116363,0.276703142196002;20567.7007485843,0.183746999938788,0.276665957080186;20619.1200004558,0.183735009392605,0.276628880898069;20670.6678004569,0.183723064276544,0.276591913341472;20722.3444699581,0.183711164390321,0.276555054102812;20774.1503311329,0.183699309534633,0.276518302875103;];
ut=4*XYZWT(1)/(XYZWT(1)+15*XYZWT(2)+3*XYZWT(3));
vt=6*XYZWT(2)/(XYZWT(1)+15*XYZWT(2)+3*XYZWT(3));
dc=((ut-ColourTemp(:,2)).^2+(vt-ColourTemp(:,3)).^2).^0.5;
q=find(dc==min(dc));
Tm=ColourTemp(q,1);
dm=dc(q);
T1=ColourTemp(q+1,1);
d1=dc(q+1);
u1=ColourTemp(q+1,2);
v1=ColourTemp(q+1,3);
T0=ColourTemp(q-1,1);
d0=dc(q-1);
u0=ColourTemp(q-1,2);
v0=ColourTemp(q-1,3);
a=d0/(T0-Tm)/(T0-T1);
b=dm/(Tm-T0)/(Tm-T1);
c=d1/(T1-T0)/(T1-Tm);
A=a+b+c;
B=-(a*(T1+Tm)+b*(T0+T1)+c*(Tm+T0));
C=a*Tm*T1+b*T0*T1+c*T0*Tm;
Tp=-B/(2*A);
duv=A*Tp^2+B*Tp+C;
p=((u1-u0)^2+(v1-v0)^2)^0.5;
p1=(d0^2+p^2-d1^2)/(2*p);
Pt=T0+p1*(T1-T0)/p;
p3=(d0^2-p1^2)^0.5;
p4=Pt;
Ls=p4+(Tp-p4)*p3*100;
if p4<0.001
    CCT=Ls;
else CCT=Tp;
end
mindc=min(dc);
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function polarlabels(data,Yt,YtLab)
global ps
global strTemp
Angles=[0:30:330];
ph=findall(gca,'type','text');polar(data(1,1),data(1,2));
ps=(get(ph,'string'));
nthplot=1;

for i=1:size(ps, 1)%convert cell to double
   strTemp = str2num(char( ps(i) ));
   if isempty(strTemp);strTemp=-100;end
   switch strTemp, case 30; nthplot=0;end
   psd(i)=strTemp;
end

if nthplot==0;
    for i=1:length(Yt);pos(i)=(find(psd==Yt(i)));end
     ps(4:15)={''};
     for i=1:length(pos);ps(pos(i))=YtLab(i);end
     set(ph,{'string'},ps);
     ps=get(ph,'fontweight');
     ps(pos)={'bold'};
     set(ph,{'fontweight'},ps);
     ps=get(ph,'fontsize');
     ps(pos)={12};
     set(ph,{'fontsize'},ps);
end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function f=radarplot(R,Lable,LineColor,FillColor,LineStyle,LevelNum)
%Creates a radar (spider) plot for multi-data series.
%edit by Cheng Li, Tsinghua University
%edit by K. Smet, Catholic College Univerity Ghent
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
n=size(R,2);
m=size(R,1);

if nargin<6
    LevelNum=6;
end

R=[R R(:,1)];

[Theta,M]=meshgrid(2*pi/n*[0:n]+pi/n,ones(1,size(R,1)));
alpha=-120*pi/180;
Theta=-(Theta+alpha);
X=R.*sin(Theta);
Y=R.*cos(Theta);

A=plot(X',Y','LineWidth',2);


MAXAXIS=max(max(R))*1.1;
axis([-MAXAXIS MAXAXIS -MAXAXIS MAXAXIS]);
axis equal
axis off


if LevelNum>0
    AxisR=linspace(0,max(max(R)),LevelNum);
    beta=1.6;r=0.9;
    for i=1:LevelNum
        text(r.*AxisR(i)*sin(-(pi/n-beta)),r.*AxisR(i)*cos(-(pi/n-beta)),num2str(AxisR(i),2),'FontSize',10)
    end
    [M,AxisR]=meshgrid(ones(1,n),AxisR);
    AxisR=[AxisR AxisR(:,1)];
    [AxisTheta,M]=meshgrid(2*pi/n*[0:n]+pi/n,ones(1,size(AxisR,1)));
    AxisX=AxisR.*sin(-(AxisTheta+alpha));
    AxisY=AxisR.*cos(-(AxisTheta+alpha));
    hold on
    plot(AxisX,AxisY,':k')
    plot(AxisX',AxisY',':k')
end


if nargin>1
    if length(Lable)>=n
        LableTheta=-(2*pi/n*[0:n-1]+pi/n+alpha);
        LableR=MAXAXIS;
        LableX=LableR.*sin(LableTheta);
        LableY=LableR.*cos(LableTheta);
        for i=1:n
            if ~sum(strcmpi({'' },Lable(i)))
                text(LableX(i), LableY(i),cell2mat(Lable(i)), 'FontSize',14,'HorizontalAlignment','center','Rotation',0)
            end
        end
    end
else
    return
end

if nargin>2
    if length(LineColor)>=m
        for i=1:m
            if sum(strcmpi({'y' 'm' 'c' 'r' 'g' 'b' 'w' 'k' },LineColor(i)))
                set(A(i),'Color',cell2mat(LineColor(i)))
            end
        end
    end
else
    return
end

if nargin>3
    if length(FillColor)>=m
        for i=1:m
            if sum(strcmpi({'y' 'm' 'c' 'r' 'g' 'b' 'w' 'k' },FillColor(i)))
                hold on;
                F=fill(X(i,:),Y(i,:),cell2mat(FillColor(i)),'LineStyle','none');
                set(F,'FaceAlpha',0.3)
            end
        end
    end
else
    return
end

if nargin>4
    if length(LineStyle)>=m
        for i=1:m
            if sum(strcmpi({'-' '--' ':' '-.'},LineStyle(i)))
                set(A(i),'LineStyle',cell2mat(LineStyle(i)));
            end
        end
    end
else
    return
end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
